import{a as l,t as c}from"../chunks/disclose-version.wcsHG7oF.js";import{p as j,g as z,i as g,f as v,a as B,h as n,s as b,b as p,c as $,e as y,r as h,d as D}from"../chunks/runtime.D6lgFUio.js";import{d as P}from"../chunks/utils.Dh-XvBAd.js";import{i as L}from"../chunks/if.lkQ-IRrr.js";import{s as O}from"../chunks/attributes.BFGPVQjG.js";import{p as k}from"../chunks/proxy.r5-P5EHK.js";import{s as T,a as q}from"../chunks/store.BaapSzAp.js";import{S as w}from"../chunks/SvgIcon.Cj01WnO8.js";import{N as E}from"../chunks/index.Duto3aX0.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.DbB_HC5r.js";import{A as F}from"../chunks/AppBar.3srT6C5i.js";import{p as G}from"../chunks/stores.D4Dcgzbh.js";import"../chunks/auto_form.CxbPX2mo.js";import{A as H}from"../chunks/autotable.D6q4cofd.js";import"../chunks/index.BXdKDRLQ.js";import{L as J}from"../chunks/loader.BeY12cOT.js";import{g as K}from"../chunks/entry.Y6HcnCx3.js";import{f as M}from"../chunks/index.UdVxqQke.js";var Q=c('<ol class="breadcrumb"><li class="crumb"><a class="anchor" href="/z/pages/portal/projects/books">Books</a></li> <li class="crumb-separator" aria-hidden="">&rsaquo;</li> <li class="crumb">Sales</li></ol>'),R=()=>{},U=c('<a class="btn variant-ghost-primary btn-sm"><!> Sale</a> <button class="btn variant-filled-secondary btn-sm"><!> Close</button>',1),V=c("<!> <!>",1);function _a(S,A){j(A,!0);const N=T(),o=q(G,"$page",N).params.pid,m=E(z("__api__"));let d=g(k([])),e=g(!0);const f=async()=>{n(e,!0);const a=await m.listSales(o);a.status===200&&(n(d,k((a.data||[]).map(s=>({...s,total:M(s.total),created_at:new Date(s.created_at).toISOString(),updated_at:new Date(s.updated_at).toISOString()})))),n(e,!1))};f();var u=V(),_=v(u);F(_,{$$slots:{lead:(a,s)=>{var t=Q();l(a,t)},trail:(a,s)=>{var t=U(),r=v(t);O(r,"href",`/z/pages/portal/projects/books/${o}/sales/new`);var I=$(r);w(I,{className:"h-4 w-4",name:"plus"}),y(),h(r);var i=b(r,2);i.__click=[R];var x=$(i);w(x,{className:"h-4 w-4 mr-1",name:"check"}),y(),h(i),l(a,t)}}});var C=b(_,2);L(C,()=>p(e),a=>{J(a,{})},a=>{var s=D(()=>[{Name:"preview",Class:"variant-filled-primary",Action:async t=>{K(`/z/pages/portal/projects/books/${o}/sales/preview?sid=${t}`)}},{Name:"options",Class:"variant-filled-secondary",Action:async t=>{}},{Name:"delete",Class:"variant-filled-error",Action:async t=>{(await m.deleteSale(o,t)).status===200&&f()}}]);H(a,{action_key:"id",key_names:[["id","ID"],["title","Title"],["notes","Notes"],["total","Total"],["created_at","Created At"]],get datas(){return p(d)},color:["ctype"],get actions(){return p(s)}})}),l(S,u),B()}P(["click"]);export{_a as component};
