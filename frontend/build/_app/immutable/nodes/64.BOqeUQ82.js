import{s as j,a as B,x as C,g as O,i as g,f,k as q,q as x,e as v,c as S,w as D,m as w,n as A,t as N,b as T,d as I,h as L,y as E}from"../chunks/scheduler.BSMlFrmR.js";import{S as H,i as M,c as b,b as h,m as k,a as d,d as P,t as $,e as y,g as U}from"../chunks/index.DIQEG9mn.js";import{S as z}from"../chunks/SvgIcon.DwWRhvCX.js";import{N as F}from"../chunks/index.Duto3aX0.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.CPOc6-8_.js";import{A as G}from"../chunks/AppBar.DjVK2Awi.js";import{p as J}from"../chunks/stores.ljWIZ5Ll.js";import{A as K}from"../chunks/autotable.Cxn6HL1P.js";import{L as Q}from"../chunks/loader.BC9BD-QK.js";import{g as R}from"../chunks/entry.D8xZB6l6.js";import{f as V}from"../chunks/index.UdVxqQke.js";function W(i){let e,s='<li class="crumb"><a class="anchor" href="/z/pages/portal/projects/books">Books</a></li> <li class="crumb-separator" aria-hidden="">â€º</li> <li class="crumb">Sales</li>';return{c(){e=v("ol"),e.innerHTML=s,this.h()},l(t){e=S(t,"OL",{class:!0,"data-svelte-h":!0}),D(e)!=="svelte-q69zr7"&&(e.innerHTML=s),this.h()},h(){w(e,"class","breadcrumb")},m(t,r){g(t,e,r)},p:A,d(t){t&&f(e)}}}function X(i){let e,s,t,r,o,p,m,l,u,n;return s=new z({props:{className:"h-4 w-4",name:"plus"}}),p=new z({props:{className:"h-4 w-4 mr-1",name:"check"}}),{c(){e=v("a"),b(s.$$.fragment),t=N(`
            Sale`),r=B(),o=v("button"),b(p.$$.fragment),m=N(`

            Close`),this.h()},l(a){e=S(a,"A",{href:!0,class:!0});var c=T(e);h(s.$$.fragment,c),t=I(c,`
            Sale`),c.forEach(f),r=O(a),o=S(a,"BUTTON",{class:!0});var _=T(o);h(p.$$.fragment,_),m=I(_,`

            Close`),_.forEach(f),this.h()},h(){w(e,"href",`/z/pages/portal/projects/books/${i[2]}/sales/new`),w(e,"class","btn variant-ghost-primary btn-sm"),w(o,"class","btn variant-filled-secondary btn-sm")},m(a,c){g(a,e,c),k(s,e,null),L(e,t),g(a,r,c),g(a,o,c),k(p,o,null),L(o,m),l=!0,u||(n=E(o,"click",te),u=!0)},p:A,i(a){l||($(s.$$.fragment,a),$(p.$$.fragment,a),l=!0)},o(a){d(s.$$.fragment,a),d(p.$$.fragment,a),l=!1},d(a){a&&(f(e),f(r),f(o)),y(s),y(p),u=!1,n()}}}function Y(i){let e,s;return e=new K({props:{action_key:"id",key_names:[["id","ID"],["title","Title"],["notes","Notes"],["total","Total"],["created_at","Created At"]],datas:i[0],color:["ctype"],actions:[{Name:"preview",Class:"variant-filled-primary",Action:i[5]},{Name:"options",Class:"variant-filled-secondary",Action:ae},{Name:"delete",Class:"variant-filled-error",Action:i[6]}]}}),{c(){b(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,r){k(e,t,r),s=!0},p(t,r){const o={};r&1&&(o.datas=t[0]),e.$set(o)},i(t){s||($(e.$$.fragment,t),s=!0)},o(t){d(e.$$.fragment,t),s=!1},d(t){y(e,t)}}}function Z(i){let e,s;return e=new Q({}),{c(){b(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,r){k(e,t,r),s=!0},p:A,i(t){s||($(e.$$.fragment,t),s=!0)},o(t){d(e.$$.fragment,t),s=!1},d(t){y(e,t)}}}function ee(i){let e,s,t,r,o,p;e=new G({props:{$$slots:{trail:[X],lead:[W]},$$scope:{ctx:i}}});const m=[Z,Y],l=[];function u(n,a){return n[1]?0:1}return t=u(i),r=l[t]=m[t](i),{c(){b(e.$$.fragment),s=B(),r.c(),o=C()},l(n){h(e.$$.fragment,n),s=O(n),r.l(n),o=C()},m(n,a){k(e,n,a),g(n,s,a),l[t].m(n,a),g(n,o,a),p=!0},p(n,[a]){const c={};a&256&&(c.$$scope={dirty:a,ctx:n}),e.$set(c);let _=t;t=u(n),t===_?l[t].p(n,a):(U(),d(l[_],1,1,()=>{l[_]=null}),P(),r=l[t],r?r.p(n,a):(r=l[t]=m[t](n),r.c()),$(r,1),r.m(o.parentNode,o))},i(n){p||($(e.$$.fragment,n),$(r),p=!0)},o(n){d(e.$$.fragment,n),d(r),p=!1},d(n){n&&(f(s),f(o)),y(e,n),l[t].d(n)}}}const te=()=>{},ae=async i=>{};function se(i,e,s){let t;q(i,J,a=>s(7,t=a));const r=t.params.pid,o=F(x("__api__"));let p=[],m=!0;const l=async()=>{s(1,m=!0);const a=await o.listSales(r);a.status===200&&(s(0,p=(a.data||[]).map(c=>({...c,total:V(c.total),created_at:new Date(c.created_at).toISOString(),updated_at:new Date(c.updated_at).toISOString()}))),s(1,m=!1))};return l(),[p,m,r,o,l,async a=>{R(`/z/pages/portal/projects/books/${r}/sales/preview?sid=${a}`)},async a=>{(await o.deleteSale(r,a)).status===200&&l()}]}class de extends H{constructor(e){super(),M(this,e,se,ee,j,{})}}export{de as component};
