import{s as E,a as F,x as q,g as V,i as x,f as A,k as H,q as G,e as J,c as K,w as O,m as P,n as W}from"../chunks/scheduler.BSMlFrmR.js";import{S as Q,i as R,c as B,b as C,m as M,a as k,d as U,t as h,e as N,g as X}from"../chunks/index.DIQEG9mn.js";import"../chunks/entry.DdBPhNA2.js";import{g as Y}from"../chunks/stores.n0Zj223A.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.CPOc6-8_.js";import{A as Z}from"../chunks/AppBar.DjVK2Awi.js";import{L as y}from"../chunks/loader.BC9BD-QK.js";import{N as v}from"../chunks/index.Duto3aX0.js";import{p as L}from"../chunks/stores.Ct4hmiyJ.js";import{T as ee}from"../chunks/TxnForm.B4X1EPuZ.js";import{p as te}from"../chunks/index.jNSSX7nP.js";function oe(i){let t,o='<ol class="breadcrumb"><li class="crumb"><a class="anchor" href="/z/pages/portal/projects/books">Books</a></li> <li class="crumb-separator" aria-hidden="">â€º</li> <li class="crumb">Edit Transaction</li></ol>';return{c(){t=J("div"),t.innerHTML=o,this.h()},l(e){t=K(e,"DIV",{slot:!0,class:!0,"data-svelte-h":!0}),O(t)!=="svelte-d96juo"&&(t.innerHTML=o),this.h()},h(){P(t,"slot","lead"),P(t,"class","flex gap-2")},m(e,n){x(e,t,n)},p:W,d(e){e&&A(t)}}}function ne(i){let t,o;return t=new ee({props:{onSubmit:i[8],edit:!0,title:i[1],notes:i[2],debit_account_id:i[3],credit_account_id:i[4],debit_amount:i[5],credit_amount:i[6],reference_id:i[7]}}),{c(){B(t.$$.fragment)},l(e){C(t.$$.fragment,e)},m(e,n){M(t,e,n),o=!0},p(e,n){const _={};n&2&&(_.title=e[1]),n&4&&(_.notes=e[2]),n&8&&(_.debit_account_id=e[3]),n&16&&(_.credit_account_id=e[4]),n&32&&(_.debit_amount=e[5]),n&64&&(_.credit_amount=e[6]),n&128&&(_.reference_id=e[7]),t.$set(_)},i(e){o||(h(t.$$.fragment,e),o=!0)},o(e){k(t.$$.fragment,e),o=!1},d(e){N(t,e)}}}function re(i){let t,o;return t=new y({}),{c(){B(t.$$.fragment)},l(e){C(t.$$.fragment,e)},m(e,n){M(t,e,n),o=!0},p:W,i(e){o||(h(t.$$.fragment,e),o=!0)},o(e){k(t.$$.fragment,e),o=!1},d(e){N(t,e)}}}function se(i){let t,o,e,n,_,d;t=new Z({props:{$$slots:{lead:[oe]},$$scope:{ctx:i}}});const g=[re,ne],l=[];function f(r,u){return r[0]?0:1}return e=f(i),n=l[e]=g[e](i),{c(){B(t.$$.fragment),o=F(),n.c(),_=q()},l(r){C(t.$$.fragment,r),o=V(r),n.l(r),_=q()},m(r,u){M(t,r,u),x(r,o,u),l[e].m(r,u),x(r,_,u),d=!0},p(r,[u]){const b={};u&1048576&&(b.$$scope={dirty:u,ctx:r}),t.$set(b);let p=e;e=f(r),e===p?l[e].p(r,u):(X(),k(l[p],1,1,()=>{l[p]=null}),U(),n=l[e],n?n.p(r,u):(n=l[e]=g[e](r),n.c()),h(n,1),n.m(_.parentNode,_))},i(r){d||(h(t.$$.fragment,r),h(n),d=!0)},o(r){k(t.$$.fragment,r),k(n),d=!1},d(r){r&&(A(o),A(_)),N(t,r),l[e].d(r)}}}function ae(i,t,o){let e,n;H(i,te,s=>o(13,e=s)),H(i,L,s=>o(14,n=s));const _=n.params.pid,d=e.tid,g=v(G("__api__"));Y();let l=!0,f,r=0,u=0,b=!0,p="",$="",w=0,T=0,I=0,S=0,D="";const z=async s=>{let m={},c={};const a={first_line_data:m,second_line_data:c,first_line_id:b?r:u,second_line_id:b?u:r,txn_data:{}};s.title!==f.title&&(a.txn_data.title=s.title),s.notes!==f.notes&&(a.txn_data.notes=s.notes),s.reference_id!==s.reference_id&&(a.txn_data.reference_id=s.reference_id),r||(c=a.first_line_data,m=a.second_line_data),s.debit_account_id!==f.debit_account_id&&(a.first_line_data.account_id=s.debit_account_id),s.credit_account_id!==f.credit_account_id&&(a.second_line_data.account_id=s.credit_account_id),s.debit_amount!==f.debit_amount&&(a.first_line_data.debit_amount=s.debit_amount),s.credit_amount!==f.credit_amount&&(a.second_line_data.credit_amount=s.credit_amount),o(0,l=!0),await g.updateTxnWithLine(_,d,a),await j()},j=async()=>{o(0,l=!0);const s=await g.getTxnWithLines(_,d);if(s.status!==200){console.log("@err",l);return}let m=s.data;o(1,p=m.txn.title),o(2,$=m.txn.notes),o(7,D=m.txn.reference_id);let c=m.first_line,a=m.second_line;(c==null?void 0:c.debit_amount)===0&&(b=!1,a=m.first_line,c=m.second_line),r=(c==null?void 0:c.id)||0,u=(a==null?void 0:a.id)||0,o(3,w=(c==null?void 0:c.account_id)||0),o(4,T=(a==null?void 0:a.account_id)||0),o(5,I=(c==null?void 0:c.debit_amount)||0),o(6,S=(a==null?void 0:a.credit_amount)||0),f={title:p,notes:$,reference_id:D,debit_account_id:w,credit_account_id:T,debit_amount:I,credit_amount:S},o(0,l=!1)};return j(),[l,p,$,w,T,I,S,D,z]}class ke extends Q{constructor(t){super(),R(this,t,ae,se,E,{})}}export{ke as component};
