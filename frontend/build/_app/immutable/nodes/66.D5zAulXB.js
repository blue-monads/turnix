import{a as c,t as jt,b as g,c as Rt}from"../chunks/disclose-version.wcsHG7oF.js";import{p as zt,s as r,c as a,t as n,a as Ct,r as t,b as s,g as Vt,i as q,f as Wt,h as f,d as Nt}from"../chunks/runtime.D6lgFUio.js";import{i as y}from"../chunks/if.lkQ-IRrr.js";import{p as tt}from"../chunks/proxy.r5-P5EHK.js";import{s as Yt,a as St}from"../chunks/store.BaapSzAp.js";import{N as Zt}from"../chunks/index.Duto3aX0.js";import{p as $t}from"../chunks/stores.BfjlaKTN.js";import"../chunks/auto_form.CxbPX2mo.js";import"../chunks/autotable.D6q4cofd.js";import"../chunks/index.BXdKDRLQ.js";import{L as ta}from"../chunks/loader.BeY12cOT.js";import{p as aa}from"../chunks/index.CyuKaQbW.js";import{s as o}from"../chunks/render.CIW-w3Th.js";import{e as ra,i as ea}from"../chunks/each.CWrzZiCN.js";import{r as sa,a as kt,s as oa}from"../chunks/attributes.BFGPVQjG.js";import{d as la}from"../chunks/utils.Dh-XvBAd.js";import{r as da}from"../chunks/misc.CFrgioPu.js";import{p as na}from"../chunks/props.C7PlKWmz.js";import{g as ia}from"../chunks/stores.CebXFGJ4.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.DbB_HC5r.js";import"../chunks/entry.BlSk_uHN.js";import{f as p}from"../chunks/index.UdVxqQke.js";/* empty css                                                     */var pa=jt('<tr><td class="px-4 py-2 border"> </td><td class="px-4 py-2 text-right border tabular-nums slashed-zero"> </td><td class="px-4 py-2 text-right border tabular-nums slashed-zero"><span> </span> = <strong> </strong></td><td class="px-4 py-2 text-right border tabular-nums slashed-zero"><!></td><td class="px-4 py-2 text-right border tabular-nums slashed-zero">( <span> <!> <!></span> <strong> </strong></td></tr>'),ca=()=>{},va=jt('<form class="p-2"><div class="card"><header class="card-header flex justify-between"><h3 class="h3"> </h3></header> <section class="p-4 flex flex-col gap-4"><div class="flex gap-2 justify-between"><div class="flex flex-col gap-2"><div class="label"><span class="font-semibold">Title :</span> <span> </span></div> <div class="label"><span class="font-semibold">Billed To :</span> <a class="text-sm italic underline"> </a></div></div> <label class="label"><span>Date of Sale</span> <input type="datetime-local" class="input p-1" placeholder="Date" disabled></label></div> <div class="max-h-96 overflow-auto"><table class="w-full text-left table-auto print:text-sm" id="table-items"><thead><tr class="variant-filled print:bg-gray-300 print:text-black"><th class="px-4 py-2">Item</th><th class="px-4 py-2 text-right">Qty</th><th class="px-4 py-2 text-right">Unit Price</th><th class="px-4 py-2 text-right">Tax</th><th class="px-4 py-2 text-right">Total</th></tr></thead><tbody></tbody></table></div> <div class="flex gap-2 w-full justify-between"><label class="label flex flex-col gap-2 w-full md:w-1/2"><span>Notes</span> <textarea class="textarea p-1" rows="4" placeholder="Notes about the sale.."></textarea></label> <div class="flex flex-col gap-2 text-sm"><table><tbody><tr><td class="px-2 py-2 border border-gray-400">Total Items TAX</td><td class="px-2 py-2 border border-gray-400 text-right"><span> </span></td></tr><tr><td class="px-2 py-2 border border-gray-400">Total Items Discount</td><td class="px-2 py-2 border border-gray-400 text-right"><span> </span></td></tr><tr><td class="px-2 py-2 border border-gray-400 border-b-gray-800">Sub Total</td><td class="px-2 py-2 border border-gray-400 border-b-gray-800 text-right"><strong> </strong></td></tr><tr><td class="px-2 py-2 border border-gray-800">Overall TAX</td><td class="px-2 py-2 border border-gray-800 text-right"><span><strong> </strong> <!></span></td></tr><tr><td class="px-2 py-2 border border-gray-800">Overall Discount</td><td class="px-2 py-2 border border-gray-800 text-right"><span><strong> </strong> <!></span></td></tr><tr><td class="px-2 py-2 border border-gray-800 font-semibold">Total</td><td class="px-2 py-2 border border-gray-800 text-right font-semibold"> </td></tr></tbody></table></div></div></section> <footer class="card-footer flex justify-end"><button class="btn variant-soft-error">delete</button></footer></div></form>');function _a(B,l){zt(l,!0),ia();let T=na(l,"contactsNameIndex",19,()=>({})),I=0,N=0;var v=va(),S=a(v),_=a(S),h=a(_),k=a(h);t(h),t(_);var x=r(_,2),m=a(x),D=a(m),j=a(D),z=r(a(j),2),C=a(z);t(z),t(j);var A=r(j,2),d=r(a(A),2),u=a(d);t(d),t(A),t(D);var O=r(D,2),P=r(a(O),2);sa(P),n(()=>kt(P,new Date(l.salesData.sale.created_at).toISOString().slice(0,16))),t(O),t(m);var L=r(m,2),at=a(L),rt=r(a(at));ra(rt,21,()=>l.salesData.lines,ea,(w,e)=>{var K=pa(),R=a(K),Ut=a(R);t(R);var V=r(R),Et=a(V);t(V);var W=r(V),Y=a(W),Ft=a(Y);t(Y);var yt=r(Y,2),Gt=a(yt);n(()=>o(Gt,p((s(e).price||0)-(s(e).discount_amount||0)+(s(e).tax_amount||0)))),t(yt),t(W);var Z=r(W),Ht=a(Z);y(Ht,()=>s(e).tax_amount,b=>{var i=g();n(()=>o(i,s(e).tax_amount)),c(b,i)},b=>{var i=g("-");c(b,i)}),t(Z);var ht=r(Z),$=r(a(ht)),Dt=a($),wt=r(Dt);y(wt,()=>s(e).discount_amount,b=>{var i=g();n(()=>o(i,`- ${s(e).discount_amount??""}`)),c(b,i)});var Jt=r(wt,2);y(Jt,()=>s(e).tax_amount,b=>{var i=g();n(()=>o(i,`+ ${s(e).tax_amount??""}`)),c(b,i)}),t($);var Tt=r($),It=r(Tt),Kt=a(It);t(It),t(ht),t(K),n(()=>{o(Ut,s(e).info),o(Et,s(e).qty),o(Ft,`${s(e).price??""} - (${s(e).discount_amount??""})`),o(Dt,`${s(e).price??""} `),o(Tt,` ) * ${s(e).qty??""} = `),o(Kt,s(e).total_amount)}),c(w,K)}),t(rt),t(at),t(L);var et=r(L,2),X=a(et),M=r(a(X),2);da(M),M.disabled=!0,t(X);var st=r(X,2),ot=a(st),lt=a(ot),Q=a(lt),dt=r(a(Q)),nt=a(dt),At=a(nt);n(()=>o(At,p(l.salesData.sale.total_item_tax_amount))),t(nt),t(dt),t(Q);var U=r(Q),it=r(a(U)),pt=a(it),Ot=a(pt);n(()=>o(Ot,p(l.salesData.sale.total_item_discount_amount))),t(pt),t(it),t(U);var E=r(U),ct=r(a(E)),vt=a(ct),Pt=a(vt);n(()=>o(Pt,p(l.salesData.sale.sub_total))),t(vt),t(ct),t(E);var F=r(E),_t=r(a(F)),xt=a(_t),G=a(xt),qt=a(G);n(()=>o(qt,p(l.salesData.sale.overall_tax_amount))),t(G);var Bt=r(G,2);y(Bt,()=>I,w=>{var e=g();n(()=>o(e,`[${p(I)??""}%]`)),c(w,e)}),t(xt),t(_t),t(F);var H=r(F),mt=r(a(H)),bt=a(mt),J=a(bt),Lt=a(J);n(()=>o(Lt,p(l.salesData.sale.overall_discount_amount))),t(J);var Xt=r(J,2);y(Xt,()=>N,w=>{var e=g();n(()=>o(e,`[${p(N)??""}%]`)),c(w,e)}),t(bt),t(mt),t(H);var ut=r(H),gt=r(a(ut)),Mt=a(gt);n(()=>o(Mt,p(l.salesData.sale.total))),t(gt),t(ut),t(lt),t(ot),t(st),t(et),t(x);var ft=r(x,2),Qt=a(ft);Qt.__click=[ca],t(ft),t(S),t(v),n(()=>{o(k,`Sales #${l.salesData.sale.id??""}`),o(C,l.salesData.sale.title||""),oa(d,"href",`/z/pages/portal/projects/books/${l.pid}/contacts/edit?cid=${l.salesData.sale.client_id}`),o(u,T()[l.salesData.sale.client_id]||""),kt(M,l.salesData.sale.notes)}),c(B,v),Ct()}la(["click"]);function La(B,l){zt(l,!0);const T=Yt(),I=()=>St($t,"$page",T),N=()=>St(aa,"$params",T),v=I().params.pid,S=N().sid,_=Zt(Vt("__api__"));let h=q(void 0),k=q(tt([])),x=q(!0),m=q(!0);const D=async()=>{f(x,!0);const d=await _.listContacts(v);d.status===200&&(f(k,tt(d.data)),f(x,!1))};(async()=>{f(m,!0);const d=await _.getSale(v,S);d.status===200&&(f(h,tt(d.data)),f(m,!1),console.log("@sale_data",d.data))})(),D();let z=Nt(()=>s(k).reduce((d,u)=>{const O=u.id,P=u.name;return d[O]=P,d},{}));var C=Rt(),A=Wt(C);y(A,()=>s(x)||s(m),d=>{ta(d,{})},d=>{var u=Nt(()=>Number(v));_a(d,{api:_,get salesData(){return s(h)},get pid(){return s(u)},get contactsNameIndex(){return s(z)}})}),c(B,C),Ct()}export{La as component};
