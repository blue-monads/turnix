import{a as s,n as k,c as st,t as V,b as it}from"./disclose-version.wcsHG7oF.js";import{t as f,p as dt,h as B,f as O,b as e,a as ht,i as P,g as At,s as _,c,r as v,d as G}from"./runtime.D6lgFUio.js";import{s as F}from"./render.CIW-w3Th.js";import{i as u}from"./if.lkQ-IRrr.js";import{e as rt,i as ot}from"./each.CWrzZiCN.js";import{s as p,r as Lt,c as Ct}from"./attributes.BFGPVQjG.js";import{s as Ft}from"./class.B3zfNKG1.js";import{d as It}from"./utils.Dh-XvBAd.js";import{p as vt}from"./proxy.r5-P5EHK.js";import{p as St,s as lt}from"./event-modifiers.Bfc47y5P.js";import{p as d}from"./props.C7PlKWmz.js";import{c as Nt,o as qt}from"./index-client.ROjlL4Km.js";import"./auto_form.CxbPX2mo.js";import"./autotable.D6q4cofd.js";import"./index.BXdKDRLQ.js";import{L as Dt}from"./loader.BeY12cOT.js";import{c as Et}from"./svelte-component.BVq4HXH7.js";import{S as K}from"./SvgIcon.Cj01WnO8.js";import{g as nt}from"./entry.BlSk_uHN.js";import{g as jt}from"./stores.CebXFGJ4.js";import"./ProgressBar.svelte_svelte_type_style_lang.DbB_HC5r.js";var Tt=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="text-purple-500 inline-block bi bi-image" viewBox="0 0 16 16"><path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"></path><path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"></path></svg>');function Ut(r,t){let i=d(t,"width",3,"16"),n=d(t,"height",3,"16");var a=Tt();f(()=>{p(a,"width",i()),p(a,"height",n())}),s(r,a)}var Gt=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="text-yellow-600 inline-block bi bi-music-note-beamed" viewBox="0 0 16 16"><path d="M6 13c0 1.105-1.12 2-2.5 2S1 14.105 1 13c0-1.104 1.12-2 2.5-2s2.5.896 2.5 2zm9-2c0 1.105-1.12 2-2.5 2s-2.5-.895-2.5-2 1.12-2 2.5-2 2.5.895 2.5 2z"></path><path fill-rule="evenodd" d="M14 11V2h1v9h-1zM6 3v10H5V3h1z"></path><path d="M5 2.905a1 1 0 0 1 .9-.995l8-.8a1 1 0 0 1 1.1.995V3L5 4V2.905z"></path></svg>');function Kt(r,t){let i=d(t,"width",3,"16"),n=d(t,"height",3,"16");var a=Gt();f(()=>{p(a,"width",i()),p(a,"height",n())}),s(r,a)}var Ot=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="text-indigo-500 inline-block ltr:mr-1 rtl:ml-1 bi bi-file-earmark" viewBox="0 0 16 16"><path d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5h-2z"></path></svg>');function Pt(r,t){let i=d(t,"width",3,"16"),n=d(t,"height",3,"16");var a=Ot();f(()=>{p(a,"width",i()),p(a,"height",n())}),s(r,a)}var Rt=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="text-red-500 inline-block bi bi-play-btn-fill" viewBox="0 0 16 16"><path d="M0 12V4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm6.79-6.907A.5.5 0 0 0 6 5.5v5a.5.5 0 0 0 .79.407l3.5-2.5a.5.5 0 0 0 0-.814l-3.5-2.5z"></path></svg>');function Zt(r,t){let i=d(t,"width",3,"16"),n=d(t,"height",3,"16");var a=Rt();f(()=>{p(a,"width",i()),p(a,"height",n())}),s(r,a)}var Jt=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="inline-block bi bi-file-zip" viewBox="0 0 16 16"><path d="M6.5 7.5a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v.938l.4 1.599a1 1 0 0 1-.416 1.074l-.93.62a1 1 0 0 1-1.109 0l-.93-.62a1 1 0 0 1-.415-1.074l.4-1.599V7.5zm2 0h-1v.938a1 1 0 0 1-.03.243l-.4 1.598.93.62.93-.62-.4-1.598a1 1 0 0 1-.03-.243V7.5z"></path><path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm5.5-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9v1H8v1h1v1H8v1h1v1H7.5V5h-1V4h1V3h-1V2h1V1z"></path></svg>');function Qt(r,t){let i=d(t,"width",3,"16"),n=d(t,"height",3,"16");var a=Jt();f(()=>{p(a,"width",i()),p(a,"height",n())}),s(r,a)}function Wt(r,t){dt(t,!0);let i=d(t,"name",3,"");const n={image:Ut,video:Zt,music:Kt,zip:Qt,other:Pt},a={mp4:"video",jpg:"image",png:"image",webp:"image",mp3:"music",zip:"zip"};let b=P("other");i().includes(".")&&B(b,vt(a[i().split(".").pop()]||"other"));var A=st(),y=O(A);Et(y,()=>n[e(b)],(I,L)=>{L(I,{get height(){return t.size},get width(){return t.size}})}),s(r,A),ht()}var Xt=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="inline-block bi bi-folder-fill" viewBox="0 0 16 16"><path d="M9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.825a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31L.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3zm-8.322.12C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139z"></path></svg>');function Yt(r,t){let i=d(t,"size",3,"16");var n=Xt();f(()=>{p(n,"width",i()),p(n,"height",i())}),s(r,n)}var $t=(r,t,i)=>t("open_item",e(i)),te=(r,t,i)=>t("select_item",e(i)),ee=V('<input type="checkbox">'),ae=(r,t,i)=>t(e(i)),ie=V('<button class="btn btn-sm variant-filled"><!></button>'),re=V('<button class="flex gap-1 justify-start items-center p-1 rounded-lg hover:bg-white hover:text-secondary-600"><!> <p> </p></button>'),oe=V('<!> <button class="btn btn-sm variant-filled-secondary relative group transition-all duration-200 focus:overflow-visible overflow-hidden"><!> <div class="absolute shadow-lg top-8 -left-16 w-28 h-max p-1 border border-zinc-200 rounded-lg flex flex-col gap-2 variant-filled"></div></button>',1),le=V('<tr><td class="w-1"><!></td><td><button class="mr-1 text-indigo-500" type="button"><!> </button></td><td><!></td><td><!></td><td><!></td></tr>'),ne=V('<div class="table-container"><table class="table table-hover overflow-auto"><thead><tr><td></td><th>Name</th><th>Created At</th><th>Size</th><th>Action</th></tr></thead><tbody><!></tbody></table></div>');function Ae(r,t){dt(t,!0);let i=d(t,"files",19,()=>[]),n=d(t,"loading",3,!1),a=d(t,"baseUrl",3,"/z/pages/portal/self/files"),b=d(t,"path",3,""),A=At("__api__");const y=Nt(),I=jt();let L="32";const ct=o=>()=>{o.is_folder?nt(`${a()}?folder=${b()?b()+"/"+o.name:o.name}`):nt(`${a()}/preview?folder=${b()}&fid=${o.id}&filename=${o.name}`)},mt=[{name:"rename",icon:"pencil-square"},{name:"download",icon:"arrow-down-on-square"},{name:"delete",icon:"trash"}],pt=[{name:"rename",icon:"pencil-square"},{name:"delete",icon:"trash"}];let S=P(!1),C=P(0);const R=o=>{B(S,!1),B(C,0)};qt(()=>(document.addEventListener("click",R),()=>{document.removeEventListener("click",R)}));const gt=o=>{const M=["Bytes","KB","MB","GB","TB"];if(o===0)return"0 Byte";const w=parseInt(String(Math.floor(Math.log(o)/Math.log(1024))));return w===0?`${o} ${M[w]}`:`${(o/1024**w).toFixed(1)} ${M[w]}`},ft=o=>{I.trigger({type:"component",component:"file_preview_dialog",meta:{api:A,fileId:o.id,filename:o.name}})};var N=ne(),Z=c(N),J=_(c(Z)),_t=c(J);u(_t,n,o=>{Dt(o,{})},o=>{var M=st(),w=O(M);rt(w,17,i,ot,(ut,l)=>{var x=le();x.__dblclick=[$t,y,l],x.__click=[te,y,l];var q=c(x),bt=c(q);u(bt,()=>t.selected===e(l).name,m=>{var h=ee();Lt(h),Ct(h,!0),s(m,h)}),v(q);var D=_(q),E=c(D),wt=G(()=>St(ct(e(l))));E.__click=function(...m){var h;(h=e(wt))==null||h.apply(this,m)};var Q=c(E);u(Q,()=>e(l).is_folder,m=>{Yt(m,{size:L})},m=>{Wt(m,{size:L,get name(){return e(l).name}})});var xt=_(Q);v(E),v(D);var j=_(D),zt=c(j);u(zt,()=>e(l).created_at,m=>{var h=it();f(()=>F(h,new Date(e(l).created_at).toLocaleString())),s(m,h)}),v(j);var T=_(j),kt=c(T);u(kt,()=>e(l).size,m=>{var h=it();f(()=>F(h,gt(e(l).size))),s(m,h)}),v(T);var W=_(T),Vt=c(W);u(Vt,()=>!e(S)||e(C)===e(l).id,m=>{var h=oe(),X=O(h);u(X,()=>!e(l).is_folder,H=>{var g=ie();g.__click=[ae,ft,l];var z=c(g);K(z,{name:"eye",className:"w-4 h-4"}),v(g),s(H,g)});var U=_(X,2),yt=G(()=>lt(()=>{B(S,!0),B(C,vt(e(l).id)),console.log("activeFileId",e(C))}));U.__click=function(...H){var g;(g=e(yt))==null||g.apply(this,H)};var Y=c(U);K(Y,{name:"bars-3",className:"w-4 h-4"});var $=_(Y,2);rt($,21,()=>e(l).is_folder?pt:mt,ot,(H,g)=>{var z=re(),Mt=G(()=>lt(()=>{y("action",{action:e(g),row:e(l)})}));z.__click=function(...Bt){var at;(at=e(Mt))==null||at.apply(this,Bt)};var tt=c(z);K(tt,{get name(){return e(g).icon},className:"w-4 h-4"});var et=_(tt,2),Ht=c(et);v(et),v(z),f(()=>F(Ht,e(g).name)),s(H,z)}),v($),v(U),s(m,h)}),v(W),v(x),f(()=>{Ft(x,`cursor-pointer hover:bg-gray-700 ${(t.selected===e(l).name?"variant-outline-primary":"")??""}`),F(xt,` ${e(l).name??""}`)}),s(ut,x)}),s(o,M)}),v(J),v(Z),v(N),s(r,N),ht()}It(["dblclick","click"]);export{Ae as F};
