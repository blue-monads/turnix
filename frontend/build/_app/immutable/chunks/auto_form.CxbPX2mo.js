import{a as t,t as l,c as F}from"./disclose-version.wcsHG7oF.js";import{p as xa,c as i,b as a,s as N,r as v,t as _,h as na,a as Ta,d as y,i as Ea,f as L}from"./runtime.D6lgFUio.js";import{s as aa}from"./render.CIW-w3Th.js";import{i as E}from"./if.lkQ-IRrr.js";import{e as ca,i as ma}from"./each.CWrzZiCN.js";import{r as J,a as H,s as f}from"./attributes.BFGPVQjG.js";import{d as Sa}from"./utils.Dh-XvBAd.js";import{r as Ia}from"./misc.CFrgioPu.js";import{p as ka}from"./proxy.r5-P5EHK.js";import{i as La,s as Oa}from"./select.BfGKzECA.js";import{p as V}from"./props.C7PlKWmz.js";import{r as Aa}from"./legacy-client.B7AzNrU7.js";import{_ as Xa}from"./_kv_editor.SKGkUTMX.js";import{b as Ba}from"./input.DAoTAKLA.js";import{S as wa}from"./SvgIcon.Cj01WnO8.js";import{c as Da}from"./index-client.ROjlL4Km.js";var Ga=l('<div class="flex"><input type="text" class="w-full p-1 border"> <button class="bg-gray-700 rounded text-white p-2">-</button></div>'),Ma=(K,n,m,k)=>{a(n)&&(m(m()+","+a(n)),na(n,""),k())},Ua=l('<div class="flex flex-col p-1 gap-1"><!> <div class="flex mt-1"><input type="text" class="p-1 w-full border"> <button class="bg-gray-700 rounded text-white p-1">+</button></div></div>');function ja(K,n){xa(n,!0);let m=V(n,"value",15,""),k=V(n,"onChange",3,null),Y=V(n,"seperator",3,","),O=y(()=>m().split(Y())),z=Ea("");const X=()=>{k()&&k()(m())},B=M=>U=>{const j=[...a(O)];j[M]=U.target.value,m(j.toString()),X()},D=M=>()=>{const U=a(O).filter((j,P)=>P!==M);m(U.toString()),X()};var u=Ua(),G=i(u);ca(G,17,()=>a(O),ma,(M,U,j)=>{var P=Ga(),ea=i(P);J(ea);var oa=y(()=>B(j));ea.__change=function(...sa){var o;(o=a(oa))==null||o.apply(this,sa)};var ga=N(ea,2),pa=y(()=>D(j));ga.__click=function(...sa){var o;(o=a(pa))==null||o.apply(this,sa)},v(P),_(()=>H(ea,a(U))),t(M,P)});var da=N(G,2),ra=i(da);J(ra);var Q=N(ra,2);Q.__click=[Ma,z,m,X],v(da),v(u),Ba(ra,()=>a(z),M=>na(z,M)),t(K,u),Ta()}Sa(["change","click"]);const Pa=async(K,n,m)=>{na(n,!0);const k=m.onClick();k instanceof Promise&&await k,na(n,!1)};var Ra=l('<button class="btn btn-sm variant-filled"><!> </button>');function Va(K,n){xa(n,!0);let m=V(n,"name",3,""),k=Ea(!1);var Y=Ra();Y.__click=[Pa,k,n];var O=i(Y);E(O,()=>a(k),X=>{wa(X,{name:"arrow-path",className:"h-5 w-5 animate-spin"})},X=>{wa(X,{name:"arrow-down-on-square",className:"h-5 w-5"})});var z=N(O);v(Y),_(()=>aa(z,` ${m()??""}`)),t(K,Y),Ta()}Sa(["click"]);var Ya=l("<option> </option>"),qa=l('<input type="text" class="p-2 input"> <datalist></datalist>',1),Fa=l('<input type="email" class="p-2 input">'),Ha=l("<option> </option>"),Ja=l('<input type="text" class="p-2 input"> <datalist></datalist>',1),Ka=l("<option> </option>"),za=l('<select class="p-1 input"></select>'),Qa=l('<div class="flex justify-between w-full"><!> <div class="w-10 p-1 text-gray-700"><button><!></button></div></div>'),Wa=l('<input type="text" class="p-2 shadow rounded-lg bg-gray-100 outline-none focus:bg-gray-200">'),Za=l('<textarea class="p-2 textarea"></textarea>'),$a=l('<input type="number" class="p-2 shadow rounded-lg bg-gray-100 outline-none focus:bg-gray-200">'),ae=l('<div class="flex w-full justify-start"><input type="checkbox" class="p-2"></div>'),ee=l("<div>Not impl</div>"),te=l('<div class="flex-col flex py-3"><label class="pb-2 label"> </label> <!></div>'),ne=l('<div class="flex justify-end py-3"><!></div>'),re=l('<div class="h-full w-full p-4 overflow-auto"><div class="p-5 w-full card"><h3 class="h3"> </h3> <p class="text-red-500"> </p> <!> <!></div></div>');function ke(K,n){xa(n,!0);let m=V(n,"data",19,()=>({})),k=V(n,"modified",15,!1),Y=V(n,"message",3,""),O=V(n,"onSave",3,void 0),z=V(n,"noSubmit",3,!1);const X=Da();let B=Ea(ka({})),D;Aa(()=>{D={}}),Aa(()=>{console.log(`FORM_DEBUG => ${n.schema.name}`,"DATA",a(B),"ORIGINAL_DATA",m(),"SCHEMA",n.schema)});const u=o=>m()[o]||"",G=o=>e=>{Q(o)(e.target.value)},da=o=>e=>{Q(o)(Number(e.target.value))},ra=o=>e=>{Q(o)(!!e.target.checked)},Q=o=>e=>{na(B,ka({...a(B),[o]:e})),k(!0),X("modified",a(B))},M=o=>{const e="fixme";return na(B,ka({...a(B),[o]:e})),e};var U=re(),j=i(U),P=i(j),ea=i(P);v(P);var oa=N(P,2),ga=i(oa);v(oa);var pa=N(oa,2);ca(pa,17,()=>n.schema.fields,ma,(o,e,s)=>{var ha=te(),fa=i(ha);f(fa,"for",`field-${s}`);var Ca=i(fa);v(fa);var Na=N(fa,2);E(Na,()=>a(e).ftype==="TEXT",ba=>{var _a=qa(),R=L(_a);J(R),f(R,"id",`field-${s??""}`),f(R,"list",`field-${s??""}-datalist`),_(()=>H(R,u(a(e).key_name)));var va=y(()=>G(a(e).key_name));R.__change=function(...W){var w;(w=a(va))==null||w.apply(this,W)};var g=N(R,2);f(g,"id",`field-${s??""}-datalist`),ca(g,21,()=>a(e).options||[],ma,(W,w)=>{var p=Ya(),Z={},q=i(p);v(p),_(()=>{Z!==(Z=a(w))&&(p.value=(p.__value=a(w))==null?"":a(w)),aa(q,a(w))}),t(W,p)}),v(g),_(()=>R.disabled=a(e).disabled),t(ba,_a)},ba=>{var _a=F(),R=L(_a);E(R,()=>a(e).ftype==="EMAIL",va=>{var g=Fa();J(g),f(g,"id",`field-${s??""}`),f(g,"list",`field-${s??""}-datalist`),_(()=>H(g,u(a(e).key_name)));var W=y(()=>G(a(e).key_name));g.__change=function(...w){var p;(p=a(W))==null||p.apply(this,w)},_(()=>g.disabled=a(e).disabled),t(va,g)},va=>{var g=F(),W=L(g);E(W,()=>a(e).ftype==="SELECT",w=>{var p=Qa(),Z=i(p);E(Z,()=>D[s],S=>{var d=Ja(),b=L(d);J(b),f(b,"id",`field-${s??""}`),f(b,"list",`field-${s??""}-datalist`),_(()=>H(b,u(a(e).key_name)));var x=y(()=>G(a(e).key_name));b.__change=function(...c){var r;(r=a(x))==null||r.apply(this,c)};var A=N(b,2);f(A,"id",`field-${s??""}-datalist`),ca(A,21,()=>a(e).options||[],ma,(c,r)=>{var T=Ha(),I={},C=i(T);v(T),_(()=>{I!==(I=a(r))&&(T.value=(T.__value=a(r))==null?"":a(r)),aa(C,a(r))}),t(c,T)}),v(A),_(()=>b.disabled=a(e).disabled),t(S,d)},S=>{var d=za();f(d,"id",`field-${s??""}`),La(d,()=>u(a(e).key_name));var b,x=y(()=>G(a(e).key_name));d.__change=function(...A){var c;(c=a(x))==null||c.apply(this,A)},ca(d,21,()=>a(e).options||[],ma,(A,c)=>{var r=Ka(),T={},I=i(r);v(r),_(()=>{T!==(T=a(c))&&(r.value=(r.__value=a(c))==null?"":a(c)),aa(I,a(c))}),t(A,r)}),v(d),_(()=>{b!==(b=u(a(e).key_name))&&(d.value=(d.__value=u(a(e).key_name))==null?"":u(a(e).key_name),Oa(d,u(a(e).key_name)))}),t(S,d)});var q=N(Z,2),h=i(q);h.__click=()=>{D[s]=!D[s],D=D};var la=i(h),$=y(()=>D[s]?"lock-open":"lock-closed");wa(la,{get name(){return a($)},className:"w-6 h-6"}),v(h),v(q),v(p),t(w,p)},w=>{var p=F(),Z=L(p);E(Z,()=>a(e).ftype==="TEXT_SLUG",q=>{var h=Wa();J(h),f(h,"id",`field-${s??""}`),f(h,"list",`field-${s??""}-datalist`),_(()=>H(h,u(a(e).key_name)||(a(e).slug_gen?a(e).slug_gen():M(a(e).key_name))));var la=y(()=>G(a(e).key_name));h.__change=function(...$){var S;(S=a(la))==null||S.apply(this,$)},_(()=>h.disabled=a(e).disabled),t(q,h)},q=>{var h=F(),la=L(h);E(la,()=>a(e).ftype==="MULTI_TEXT",$=>{var S=y(()=>Q(a(e).key_name)),d=y(()=>u(a(e).key_name));ja($,{get onChange(){return a(S)},get value(){return a(d)}})},$=>{var S=F(),d=L(S);E(d,()=>a(e).ftype==="LONG_TEXT"||a(e).ftype==="TEXT_POLICY",b=>{var x=Za();Ia(x),f(x,"id",`field-${s}`),_(()=>H(x,u(a(e).key_name)));var A=y(()=>G(a(e).key_name));x.__change=function(...c){var r;(r=a(A))==null||r.apply(this,c)},_(()=>x.disabled=a(e).disabled),t(b,x)},b=>{var x=F(),A=L(x);E(A,()=>a(e).ftype==="INT",c=>{var r=$a();J(r),f(r,"id",`field-${s}`),_(()=>H(r,u(a(e).key_name)));var T=y(()=>da(a(e).key_name));r.__change=function(...I){var C;(C=a(T))==null||C.apply(this,I)},_(()=>r.disabled=a(e).disabled),t(c,r)},c=>{var r=F(),T=L(r);E(T,()=>a(e).ftype==="BOOL",I=>{var C=ae(),ta=i(C);J(ta),f(ta,"id",`field-${s}`),_(()=>H(ta,u(a(e).key_name)||!1));var ia=y(()=>ra(a(e).key_name));ta.__change=function(...ua){var ya;(ya=a(ia))==null||ya.apply(this,ua)},v(C),t(I,C)},I=>{var C=F(),ta=L(C);E(ta,()=>a(e).ftype==="KEY_VALUE_TEXT",ia=>{var ua=y(()=>m()[a(e).key_name]||{});Xa(ia,{get data(){return a(ua)},onChange:ya=>{Q(a(e).key_name)(JSON.stringify(ya))}})},ia=>{var ua=ee();t(ia,ua)},!0),t(I,C)},!0),t(c,r)},!0),t(b,x)},!0),t($,S)},!0),t(q,h)},!0),t(w,p)},!0),t(va,g)},!0),t(ba,_a)}),v(ha),_(()=>aa(Ca,a(e).name)),t(o,ha)});var sa=N(pa,2);E(sa,()=>k()&&!z(),o=>{var e=ne(),s=i(e);Va(s,{name:"Save",onClick:()=>{O()&&O()(a(B))}}),v(e),t(o,e)}),v(j),v(U),_(()=>{aa(ea,n.schema.name),aa(ga,Y()||"")}),t(K,U),Ta()}Sa(["change","click"]);export{ke as A};
