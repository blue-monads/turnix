import{s as ie,e as g,a as I,c as p,b as v,w as se,g as N,f as n,m,i as Y,h as l,n as Z,v as ne,t as O,x as $,d as V,j as F}from"./scheduler.Dy-hT7lj.js";import{e as J}from"./each.D6YF6ztN.js";import{S as ce,i as de}from"./index.jcCBAMyh.js";import{f as K}from"./index.UdVxqQke.js";function ee(i,e,t){const r=i.slice();return r[3]=e[t],r}function te(i,e,t){const r=i.slice();return r[6]=e[t],r}function le(i){let e,t=K(i[6].credit_amount)+"",r;return{c(){e=g("span"),r=O(t),this.h()},l(o){e=p(o,"SPAN",{class:!0});var d=v(e);r=V(d,t),d.forEach(n),this.h()},h(){m(e,"class","chip variant-ghost")},m(o,d){Y(o,e,d),l(e,r)},p(o,d){d&1&&t!==(t=K(o[6].credit_amount)+"")&&F(r,t)},d(o){o&&n(e)}}}function re(i){let e,t=K(i[6].debit_amount)+"",r;return{c(){e=g("span"),r=O(t),this.h()},l(o){e=p(o,"SPAN",{class:!0});var d=v(e);r=V(d,t),d.forEach(n),this.h()},h(){m(e,"class","chip variant-ghost")},m(o,d){Y(o,e,d),l(e,r)},p(o,d){d&1&&t!==(t=K(o[6].debit_amount)+"")&&F(r,t)},d(o){o&&n(e)}}}function ae(i){let e,t,r,o,d,u,S,s,c,T=(i[1][i[6].account_id]||"")+"",a,x,w,C,y,j,H,L,P,R,D=i[6].credit_amount&&le(i),E=i[6].debit_amount&&re(i);return{c(){e=g("tr"),t=g("td"),r=I(),o=g("td"),d=I(),u=g("td"),S=I(),s=g("td"),c=g("span"),a=O(T),x=I(),w=g("td"),D&&D.c(),C=I(),y=g("td"),E&&E.c(),j=I(),H=g("td"),L=I(),P=g("td"),R=I(),this.h()},l(b){e=p(b,"TR",{});var _=v(e);t=p(_,"TD",{role:!0}),v(t).forEach(n),r=N(_),o=p(_,"TD",{role:!0}),v(o).forEach(n),d=N(_),u=p(_,"TD",{role:!0}),v(u).forEach(n),S=N(_),s=p(_,"TD",{role:!0});var M=v(s);c=p(M,"SPAN",{class:!0});var q=v(c);a=V(q,T),q.forEach(n),M.forEach(n),x=N(_),w=p(_,"TD",{role:!0});var z=v(w);D&&D.l(z),z.forEach(n),C=N(_),y=p(_,"TD",{role:!0});var B=v(y);E&&E.l(B),B.forEach(n),j=N(_),H=p(_,"TD",{role:!0}),v(H).forEach(n),L=N(_),P=p(_,"TD",{role:!0}),v(P).forEach(n),R=N(_),_.forEach(n),this.h()},h(){m(t,"role","gridcell"),m(o,"role","gridcell"),m(u,"role","gridcell"),m(c,"class","chip variant-filled"),m(s,"role","gridcell"),m(w,"role","gridcell"),m(y,"role","gridcell"),m(H,"role","gridcell"),m(P,"role","gridcell")},m(b,_){Y(b,e,_),l(e,t),l(e,r),l(e,o),l(e,d),l(e,u),l(e,S),l(e,s),l(s,c),l(c,a),l(e,x),l(e,w),D&&D.m(w,null),l(e,C),l(e,y),E&&E.m(y,null),l(e,j),l(e,H),l(e,L),l(e,P),l(e,R)},p(b,_){_&3&&T!==(T=(b[1][b[6].account_id]||"")+"")&&F(a,T),b[6].credit_amount?D?D.p(b,_):(D=le(b),D.c(),D.m(w,null)):D&&(D.d(1),D=null),b[6].debit_amount?E?E.p(b,_):(E=re(b),E.c(),E.m(y,null)):E&&(E.d(1),E=null)},d(b){b&&n(e),D&&D.d(),E&&E.d()}}}function oe(i){let e,t,r=i[3].txn.id+"",o,d,u,S=i[3].txn.title+"",s,c,T,a=i[3].txn.notes+"",x,w,C,y,j,H,L,P,R,D,E,b,_,M,q,z,B=J(i[3].lines),A=[];for(let h=0;h<B.length;h+=1)A[h]=ae(te(i,B,h));return{c(){e=g("tr"),t=g("td"),o=O(r),d=I(),u=g("td"),s=O(S),c=I(),T=g("td"),x=O(a),w=I(),C=g("td"),y=I(),j=g("td"),H=I(),L=g("td"),P=I(),R=g("td"),D=I(),E=g("td"),b=g("a"),_=O("edit"),q=I();for(let h=0;h<A.length;h+=1)A[h].c();z=$(),this.h()},l(h){e=p(h,"TR",{});var f=v(e);t=p(f,"TD",{role:!0});var k=v(t);o=V(k,r),k.forEach(n),d=N(f),u=p(f,"TD",{role:!0});var G=v(u);s=V(G,S),G.forEach(n),c=N(f),T=p(f,"TD",{role:!0});var U=v(T);x=V(U,a),U.forEach(n),w=N(f),C=p(f,"TD",{role:!0}),v(C).forEach(n),y=N(f),j=p(f,"TD",{role:!0}),v(j).forEach(n),H=N(f),L=p(f,"TD",{role:!0}),v(L).forEach(n),P=N(f),R=p(f,"TD",{role:!0}),v(R).forEach(n),D=N(f),E=p(f,"TD",{role:!0});var W=v(E);b=p(W,"A",{class:!0,href:!0});var X=v(b);_=V(X,"edit"),X.forEach(n),W.forEach(n),f.forEach(n),q=N(h);for(let Q=0;Q<A.length;Q+=1)A[Q].l(h);z=$(),this.h()},h(){m(t,"role","gridcell"),m(u,"role","gridcell"),m(T,"role","gridcell"),m(C,"role","gridcell"),m(j,"role","gridcell"),m(L,"role","gridcell"),m(R,"role","gridcell"),m(b,"class","underline"),m(b,"href",M=`/z/pages/portal/projects/books/${i[2]}/txn/edit?tid=${i[3].txn.id}`),m(E,"role","gridcell")},m(h,f){Y(h,e,f),l(e,t),l(t,o),l(e,d),l(e,u),l(u,s),l(e,c),l(e,T),l(T,x),l(e,w),l(e,C),l(e,y),l(e,j),l(e,H),l(e,L),l(e,P),l(e,R),l(e,D),l(e,E),l(E,b),l(b,_),Y(h,q,f);for(let k=0;k<A.length;k+=1)A[k]&&A[k].m(h,f);Y(h,z,f)},p(h,f){if(f&1&&r!==(r=h[3].txn.id+"")&&F(o,r),f&1&&S!==(S=h[3].txn.title+"")&&F(s,S),f&1&&a!==(a=h[3].txn.notes+"")&&F(x,a),f&5&&M!==(M=`/z/pages/portal/projects/books/${h[2]}/txn/edit?tid=${h[3].txn.id}`)&&m(b,"href",M),f&3){B=J(h[3].lines);let k;for(k=0;k<B.length;k+=1){const G=te(h,B,k);A[k]?A[k].p(G,f):(A[k]=ae(G),A[k].c(),A[k].m(z.parentNode,z))}for(;k<A.length;k+=1)A[k].d(1);A.length=B.length}},d(h){h&&(n(e),n(q),n(z)),ne(A,h)}}}function he(i){let e,t,r,o='<tr><th role="columnheader">#</th> <th role="columnheader">Title</th> <th role="columnheader">Notes</th> <th role="columnheader">Account</th> <th role="columnheader">Debit</th> <th role="columnheader">Credit</th> <th role="columnheader">Attachments</th> <th role="columnheader">Actions</th></tr>',d,u,S=J(i[0]),s=[];for(let c=0;c<S.length;c+=1)s[c]=oe(ee(i,S,c));return{c(){e=g("div"),t=g("table"),r=g("thead"),r.innerHTML=o,d=I(),u=g("tbody");for(let c=0;c<s.length;c+=1)s[c].c();this.h()},l(c){e=p(c,"DIV",{class:!0});var T=v(e);t=p(T,"TABLE",{class:!0});var a=v(t);r=p(a,"THEAD",{class:!0,"data-svelte-h":!0}),se(r)!=="svelte-4ay68a"&&(r.innerHTML=o),d=N(a),u=p(a,"TBODY",{class:!0});var x=v(u);for(let w=0;w<s.length;w+=1)s[w].l(x);x.forEach(n),a.forEach(n),T.forEach(n),this.h()},h(){m(r,"class","table-head"),m(u,"class","table-body p-0 overflow-y-scroll w-full max-h-screen"),m(t,"class","table p-0 table-compact"),m(e,"class","card m-2 overflow-x-auto")},m(c,T){Y(c,e,T),l(e,t),l(t,r),l(t,d),l(t,u);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(u,null)},p(c,[T]){if(T&7){S=J(c[0]);let a;for(a=0;a<S.length;a+=1){const x=ee(c,S,a);s[a]?s[a].p(x,T):(s[a]=oe(x),s[a].c(),s[a].m(u,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=S.length}},i:Z,o:Z,d(c){c&&n(e),ne(s,c)}}}function fe(i,e,t){let{lineData:r=[]}=e,{accountsIndex:o}=e,{pid:d}=e;return console.log("@lines",r),i.$$set=u=>{"lineData"in u&&t(0,r=u.lineData),"accountsIndex"in u&&t(1,o=u.accountsIndex),"pid"in u&&t(2,d=u.pid)},[r,o,d]}class pe extends ce{constructor(e){super(),de(this,e,fe,he,ie,{lineData:0,accountsIndex:1,pid:2})}}const ve=i=>{let e={};return i.lines.forEach(t=>{let r=e[t.txn_id];r||(r=[],e[t.txn_id]=r),r.push(t)}),i.transactions.map(t=>({lines:e[t.id]||[],txn:t}))};export{pe as T,ve as f};
