import{a as A,t as D}from"../chunks/disclose-version.BOfWGsg9.js";import{p as z,g as C,f as E,a as F,h as r,b as i,i as n,s as M}from"../chunks/runtime.CmPLUjJJ.js";import{i as G}from"../chunks/if.DoU_1wcm.js";import{p as _}from"../chunks/proxy.DKs42Gzo.js";import{s as H,a as B}from"../chunks/store.BN9B0iWR.js";import"../chunks/entry.CyBKS7ox.js";import"../chunks/index.DnNofn7z.js";import"../chunks/autotable.D5y0wA8l.js";import{L as J}from"../chunks/loader._7BlSOYJ.js";import{N as K}from"../chunks/index.Dq_7tmzI.js";import{g as O}from"../chunks/stores.C0Vv8-i4.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.B5GFseBd.js";import{A as Q}from"../chunks/AppBar.DRZCjzsx.js";import{p as R}from"../chunks/stores.DkdCKZTz.js";import{T as U}from"../chunks/TxnForm.CZGvc892.js";import{p as V}from"../chunks/index.COSOhg_g.js";var X=D('<div slot="lead" class="flex gap-2"><ol class="breadcrumb"><li class="crumb"><a class="anchor" href="/z/pages/portal/projects/books">Books</a></li> <li class="crumb-separator" aria-hidden="">&rsaquo;</li> <li class="crumb">Edit Transaction</li></ol></div>'),Y=D("<!> <!>",1);function pt(N,P){z(P,!0);const v=H(),S=()=>B(R,"$page",v),W=()=>B(V,"$params",v),h=S().params.pid,T=W().tid,k=K(C("__api__"));O();let c=n(!0),s,d=0,l=0,u=!0,m=n(""),p=n(""),f=n(0),g=n(0),b=n(0),x=n(0),$=n("");const j=async t=>{let a={},o={};const e={first_line_data:a,second_line_data:o,first_line_id:u?d:l,second_line_id:u?l:d,txn_data:{}};t.title!==s.title&&(e.txn_data.title=t.title),t.notes!==s.notes&&(e.txn_data.notes=t.notes),t.reference_id!==t.reference_id&&(e.txn_data.reference_id=t.reference_id),d||(o=e.first_line_data,a=e.second_line_data),t.debit_account_id!==s.debit_account_id&&(e.first_line_data.account_id=t.debit_account_id),t.credit_account_id!==s.credit_account_id&&(e.second_line_data.account_id=t.credit_account_id),t.debit_amount!==s.debit_amount&&(e.first_line_data.debit_amount=t.debit_amount),t.credit_amount!==s.credit_amount&&(e.second_line_data.credit_amount=t.credit_amount),r(c,!0),await k.updateTxnWithLine(h,T,e),await w()},w=async()=>{r(c,!0);const t=await k.getTxnWithLines(h,T);if(t.status!==200){console.log("@err",i(c));return}let a=t.data;r(m,_(a.txn.title)),r(p,_(a.txn.notes)),r($,_(a.txn.reference_id));let o=a.first_line,e=a.second_line;(o==null?void 0:o.debit_amount)===0&&(u=!1,e=a.first_line,o=a.second_line),d=(o==null?void 0:o.id)||0,l=(e==null?void 0:e.id)||0,r(f,_((o==null?void 0:o.account_id)||0)),r(g,_((e==null?void 0:e.account_id)||0)),r(b,_((o==null?void 0:o.debit_amount)||0)),r(x,_((e==null?void 0:e.credit_amount)||0)),s={title:i(m),notes:i(p),reference_id:i($),debit_account_id:i(f),credit_account_id:i(g),debit_amount:i(b),credit_amount:i(x)},r(c,!1)};w();var I=Y(),y=E(I);Q(y,{$$slots:{lead:(t,a)=>{var o=X();A(t,o)}}});var q=M(y,2);G(q,()=>i(c),t=>{J(t,{})},t=>{U(t,{onSubmit:j,edit:!0,get title(){return i(m)},get notes(){return i(p)},get debit_account_id(){return i(f)},get credit_account_id(){return i(g)},get debit_amount(){return i(b)},get credit_amount(){return i(x)},get reference_id(){return i($)}})}),A(N,I),F()}export{pt as component};
