import{a as A,t as D}from"../chunks/uYeY98Ep.js";import{p as F,g as M,f as G,a as H,i as r,d as o,h as n,s as J}from"../chunks/CRNwc6nF.js";import{i as K}from"../chunks/DPugg-eY.js";import{p as _}from"../chunks/Ycl9y-hy.js";import{s as O,a as B}from"../chunks/xNd68Pov.js";import"../chunks/lZe3btPj.js";import"../chunks/D8sggRce.js";import"../chunks/g85Fs1Im.js";import{L as Q}from"../chunks/DDEYG0vs.js";import{N as R}from"../chunks/Dq_7tmzI.js";import{g as U}from"../chunks/Cd_4edPv.js";import"../chunks/Zb-LiZS2.js";import"../chunks/BmWNUg7v.js";import{A as V}from"../chunks/C9oD0EKA.js";import{p as X}from"../chunks/bUAA_rse.js";import{T as Y}from"../chunks/BXuyPnAu.js";import{p as Z}from"../chunks/BIb1nXgJ.js";var L=D('<div slot="lead" class="flex gap-2"><ol class="breadcrumb"><li class="crumb"><a class="anchor" href="/z/pages/portal/projects/books">Books</a></li> <li class="crumb-separator" aria-hidden="">&rsaquo;</li> <li class="crumb">Edit Transaction</li></ol></div>'),tt=D("<!> <!>",1);function xt(N,P){F(P,!0);const[$,S]=O(),W=()=>B(X,"$page",$),j=()=>B(Z,"$params",$),h=W().params.pid,T=j().tid,k=R(M("__api__"));U();let c=n(!0),s,d=0,l=0,u=!0,m=n(""),p=n(""),f=n(0),g=n(0),b=n(0),x=n(0),v=n("");const q=async t=>{let a={},i={};const e={first_line_data:a,second_line_data:i,first_line_id:u?d:l,second_line_id:u?l:d,txn_data:{}};t.title!==s.title&&(e.txn_data.title=t.title),t.notes!==s.notes&&(e.txn_data.notes=t.notes),t.reference_id!==t.reference_id&&(e.txn_data.reference_id=t.reference_id),d||(i=e.first_line_data,a=e.second_line_data),t.debit_account_id!==s.debit_account_id&&(e.first_line_data.account_id=t.debit_account_id),t.credit_account_id!==s.credit_account_id&&(e.second_line_data.account_id=t.credit_account_id),t.debit_amount!==s.debit_amount&&(e.first_line_data.debit_amount=t.debit_amount),t.credit_amount!==s.credit_amount&&(e.second_line_data.credit_amount=t.credit_amount),r(c,!0),await k.updateTxnWithLine(h,T,e),await w()},w=async()=>{r(c,!0);const t=await k.getTxnWithLines(h,T);if(t.status!==200){console.log("@err",o(c));return}let a=t.data;r(m,_(a.txn.title)),r(p,_(a.txn.notes)),r(v,_(a.txn.reference_id));let i=a.first_line,e=a.second_line;(i==null?void 0:i.debit_amount)===0&&(u=!1,e=a.first_line,i=a.second_line),d=(i==null?void 0:i.id)||0,l=(e==null?void 0:e.id)||0,r(f,_((i==null?void 0:i.account_id)||0)),r(g,_((e==null?void 0:e.account_id)||0)),r(b,_((i==null?void 0:i.debit_amount)||0)),r(x,_((e==null?void 0:e.credit_amount)||0)),s={title:o(m),notes:o(p),reference_id:o(v),debit_account_id:o(f),credit_account_id:o(g),debit_amount:o(b),credit_amount:o(x)},r(c,!1)};w();var I=tt(),y=G(I);V(y,{$$slots:{lead:(t,a)=>{var i=L();A(t,i)}}});var z=J(y,2);{var C=t=>{Q(t,{})},E=t=>{Y(t,{onSubmit:q,edit:!0,get title(){return o(m)},get notes(){return o(p)},get debit_account_id(){return o(f)},get credit_account_id(){return o(g)},get debit_amount(){return o(b)},get credit_amount(){return o(x)},get reference_id(){return o(v)}})};K(z,t=>{o(c)?t(C):t(E,!1)})}A(N,I),H(),S()}export{xt as component};
