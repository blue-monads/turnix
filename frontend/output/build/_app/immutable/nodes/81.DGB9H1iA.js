import{c as N,a as k}from"../chunks/Celh2SBM.js";import{p as I,g as h,i as m,f as y,a as C,h as n,d as e,e as c}from"../chunks/BC9Cf8Q3.js";import{i as D}from"../chunks/BgSg1_cg.js";import{p as l}from"../chunks/CKwprqj2.js";import{s as L,a as j}from"../chunks/BvXhjoeW.js";import{N as z}from"../chunks/Dq_7tmzI.js";import{p as A}from"../chunks/C1rFHlC-.js";import"../chunks/CMsATdMh.js";import"../chunks/C6IzKD7A.js";import{L as B}from"../chunks/JNyEhxU_.js";import{S as M}from"../chunks/NgzE3smS.js";import{g as O}from"../chunks/BW30Hxfo.js";function X(d,f){I(f,!0);const[g,u]=L(),s=j(A,"$page",g).params.pid,o=z(h("__api__"));let p=m(l([])),r=m(!0);(async()=>{n(r,!0);const t=await o.listContacts(s);t.status===200&&(n(p,l(t.data)),n(r,!1))})();let _=c(()=>e(p).reduce((t,a)=>{const v=a.id,w=a.name;return t[v]=w,t},{}));const x=async t=>{console.log("@submit/data",t),t.sale.sales_date=new Date(t.sale.sales_date).toISOString();const a=await o.addSale(s,t);return a.status!==200?a.data.message:(O(`/z/pages/portal/projects/books/${s}/sales`),"")};var i=N(),S=y(i);{var $=t=>{B(t,{})},b=t=>{const a=c(()=>Number(s));M(t,{name:"New Sale",get pid(){return e(a)},api:o,get contactsNameIndex(){return e(_)},submit:x})};D(S,t=>{e(r)?t($):t(b,!1)})}k(d,i),C(),u()}export{X as component};
