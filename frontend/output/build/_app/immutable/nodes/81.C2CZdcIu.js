import{c as N,a as k}from"../chunks/uYeY98Ep.js";import{p as I,g as h,h as m,f as y,a as C,i as n,d as e,e as c}from"../chunks/CRNwc6nF.js";import{i as D}from"../chunks/DPugg-eY.js";import{p as l}from"../chunks/Ycl9y-hy.js";import{s as L,a as j}from"../chunks/xNd68Pov.js";import{N as z}from"../chunks/Dq_7tmzI.js";import{p as A}from"../chunks/bUAA_rse.js";import"../chunks/D8sggRce.js";import"../chunks/g85Fs1Im.js";import{L as B}from"../chunks/DDEYG0vs.js";import{S as M}from"../chunks/CZn5bJiw.js";import{g as O}from"../chunks/lZe3btPj.js";function X(d,f){I(f,!0);const[g,u]=L(),s=j(A,"$page",g).params.pid,o=z(h("__api__"));let p=m(l([])),r=m(!0);(async()=>{n(r,!0);const t=await o.listContacts(s);t.status===200&&(n(p,l(t.data)),n(r,!1))})();let _=c(()=>e(p).reduce((t,a)=>{const v=a.id,w=a.name;return t[v]=w,t},{}));const x=async t=>{console.log("@submit/data",t),t.sale.sales_date=new Date(t.sale.sales_date).toISOString();const a=await o.addSale(s,t);return a.status!==200?a.data.message:(O(`/z/pages/portal/projects/books/${s}/sales`),"")};var i=N(),S=y(i);{var $=t=>{B(t,{})},b=t=>{const a=c(()=>Number(s));M(t,{name:"New Sale",get pid(){return e(a)},api:o,get contactsNameIndex(){return e(_)},submit:x})};D(S,t=>{e(r)?t($):t(b,!1)})}k(d,i),C(),u()}export{X as component};
