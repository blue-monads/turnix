import{a as d,t as _,c as j}from"../chunks/uYeY98Ep.js";import{p as W,g as X,h as c,u as Y,a as Z,d as e,i as l,f as P,e as I,c as p,r as m,s as q,b as ee}from"../chunks/CRNwc6nF.js";import{d as ae}from"../chunks/CHLatDmB.js";import{s as D}from"../chunks/CWnLbMF6.js";import{i as E}from"../chunks/DPugg-eY.js";import{k as re}from"../chunks/CLHGMGVy.js";import{p as o}from"../chunks/Ycl9y-hy.js";import{s as te,a as se}from"../chunks/xNd68Pov.js";import"../chunks/Zb-LiZS2.js";import"../chunks/BmWNUg7v.js";import{T as oe,a as O}from"../chunks/CUH6vHtO.js";import{C as ne}from"../chunks/LuMZZBmK.js";import{s as le,S as ie}from"../chunks/CJp-zUAu.js";import{S as de}from"../chunks/CTtbmK_c.js";import{p as pe}from"../chunks/BIb1nXgJ.js";import{E as R}from"../chunks/BJhRSVlv.js";var me=_("<span>Grid</span>"),ue=_("<span>Mappings</span>"),fe=(A,b)=>{var h;console.log("@handle",e(b)),(h=e(b))==null||h.reload()},ve=_('<!> <!> <div class="flex-1"></div> <div class="flex justify-end p-2"><button class="inline-flex rounded p.05 variant-filled self-center"><!> Run</button></div>',1),ce=_('<div class="min-h-20 overflow-auto"><!></div>'),ge=_('<div class="flex flex-col w-full h-[94vh] p-2"><div class="w-full border overflow-auto resize-y p-2 h-24 bg-white rounded"><!></div> <div class="w-full border  p-2"><div class="flex-1 w-full"><!></div></div></div>');function Ge(A,b){W(b,!0);const[h,z]=te(),F=()=>se(pe,"$params",h);let u=c(0),y=c("select * from __project__Accounts;");const H=F().pid,U=X("__api__");let f=c(o([])),w=c(o([])),T=c(void 0),G=c(void 0);const B=a=>{const x=a.at(0);x&&l(f,o(Object.keys(x).map(n=>({sqlName:n,gridName:n,rendererType:"text"}))))},$=I(()=>e(f).map(a=>({title:a.gridName,key:a.sqlName,rendererType:a.rendererType})));Y(()=>{console.log("@columnMappings",D(e(f))),console.log("@finalCoumns",D(e($)))});var C=ge(),L=p(C),J=p(L);const K=I(()=>le({dialect:ie}));ne(J,{extensions:[],get lang(){return e(K)},get value(){return e(y)},set value(a){l(y,o(a))}}),m(L);var M=q(L,2),Q=p(M),V=p(Q);oe(V,{children:(a,x)=>{var n=ve(),k=P(n);O(k,{name:"SQL Query",value:0,get group(){return e(u)},set group(r){l(u,o(r))},children:(r,g)=>{var s=me();d(r,s)},$$slots:{default:!0}});var S=q(k,2);O(S,{name:"UI",value:1,get group(){return e(u)},set group(r){l(u,o(r))},children:(r,g)=>{var s=ue();d(r,s)},$$slots:{default:!0}});var N=q(S,4),t=p(N);t.__click=[fe,T];var i=p(t);de(i,{className:"w-4 h-4 mt-1",name:"play"}),ee(),m(t),m(N),d(a,n)},$$slots:{default:!0,panel:(a,x)=>{var n=ce(),k=p(n);{var S=t=>{var i=j(),r=P(i);re(r,()=>e($),g=>{R(g,{key:"id",get columns(){return e($)},enableStartAutoLoad:!1,enablePagination:!1,enableSidebar:!1,enableSort:!1,enableFilter:!1,get initialData(){return e(w)},onLoad:async s=>{if(!e(y))return[];const v=await U.runProjectSQL2(H,{qstr:e(y),data:[]});return v.status!==200?[]:(e($).length===0&&B(v.data),l(w,o(v.data)),e(w))},get handle(){return e(T)},set handle(s){l(T,o(s))}})}),d(t,i)},N=t=>{var i=j(),r=P(i);{var g=s=>{R(s,{key:"",columns:[{title:"SQL Name",key:"sqlName"},{title:"Grid Name",key:"gridName"},{title:"Renderer Type",key:"rendererType",rendererOptions:{autoColor:!0}}],enablePagination:!1,enableSidebar:!1,enableSort:!1,onLoad:async v=>e(f),headerActions:[{name:"Add",action:()=>{l(f,o([...e(f),{sqlName:"",gridName:"",rendererType:"text"}]))}},{name:"Infer",action:()=>{}}],get handle(){return e(G)},set handle(v){l(G,o(v))}})};E(r,s=>{e(u)===1&&s(g)},!0)}d(t,i)};E(k,t=>{e(u)===0?t(S):t(N,!1)})}m(n),d(a,n)}}}),m(Q),m(M),m(C),d(A,C),Z(),z()}ae(["click"]);export{Ge as component};
