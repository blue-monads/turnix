import{a as d,t as _,c as j}from"../chunks/disclose-version.BOfWGsg9.js";import{p as K,g as V,i as c,u as W,a as X,b as e,h as l,f as L,c as p,d as P,r as m,s as q,e as Y}from"../chunks/runtime.CmPLUjJJ.js";import{d as Z}from"../chunks/events.DnYA5zBv.js";import{s as I}from"../chunks/clone.BmdS7Muu.js";import{i as D}from"../chunks/if.DoU_1wcm.js";import{k as ee}from"../chunks/key.B3I6Q0YW.js";import{p as t}from"../chunks/proxy.DKs42Gzo.js";import{s as ae,a as re}from"../chunks/store.BN9B0iWR.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.Kk8Ai2k7.js";import{T as te,a as E}from"../chunks/Tab.DYwUpmHc.js";import{C as se}from"../chunks/index.63AqBVKj.js";import{s as oe,S as ne}from"../chunks/index.BOkQpbOq.js";import{S as le}from"../chunks/SvgIcon.Cn9REWmg.js";import{p as ie}from"../chunks/index.NL8p-q19.js";import{E as O}from"../chunks/EasyGrid.Cv0QWozq.js";var de=_("<span>Grid</span>"),pe=_("<span>Mappings</span>"),me=(A,b)=>{var h;console.log("@handle",e(b)),(h=e(b))==null||h.reload()},ue=_('<!> <!> <div class="flex-1"></div> <div class="flex justify-end p-2"><button class="inline-flex rounded p.05 variant-filled self-center"><!> Run</button></div>',1),fe=_('<div class="min-h-20 overflow-auto"><!></div>'),ve=_('<div class="flex flex-col w-full h-[94vh] p-2"><div class="w-full border overflow-auto resize-y p-2 h-24 bg-white rounded"><!></div> <div class="w-full border  p-2"><div class="flex-1 w-full"><!></div></div></div>');function Pe(A,b){K(b,!0);const h=ae(),R=()=>re(ie,"$params",h);let u=c(0),y=c("select * from __project__Accounts;");const z=R().pid,F=V("__api__");let f=c(t([])),S=c(t([])),N=c(void 0),G=c(void 0);const H=r=>{const k=r.at(0);k&&l(f,t(Object.keys(k).map(s=>({sqlName:s,gridName:s,rendererType:"text"}))))},$=P(()=>e(f).map(r=>({title:r.gridName,key:r.sqlName,rendererType:r.rendererType})));W(()=>{console.log("@columnMappings",I(e(f))),console.log("@finalCoumns",I(e($)))});var w=ve(),T=p(w),U=p(T),B=P(()=>oe({dialect:ne}));se(U,{get value(){return e(y)},set value(r){l(y,t(r))},extensions:[],get lang(){return e(B)}}),m(T);var M=q(T,2),Q=p(M),J=p(Q);te(J,{children:(r,k)=>{var s=ue(),x=L(s);E(x,{get group(){return e(u)},set group(a){l(u,t(a))},name:"SQL Query",value:0,children:(a,n)=>{var C=de();d(a,C)},$$slots:{default:!0}});var v=q(x,2);E(v,{get group(){return e(u)},set group(a){l(u,t(a))},name:"UI",value:1,children:(a,n)=>{var C=pe();d(a,C)},$$slots:{default:!0}});var o=q(v,4),i=p(o);i.__click=[me,N];var g=p(i);le(g,{className:"w-4 h-4 mt-1",name:"play"}),Y(),m(i),m(o),d(r,s)},$$slots:{default:!0,panel:(r,k)=>{var s=fe(),x=p(s);D(x,()=>e(u)===0,v=>{var o=j(),i=L(o);ee(i,()=>e($),g=>{O(g,{key:"id",get handle(){return e(N)},set handle(a){l(N,t(a))},get columns(){return e($)},enableStartAutoLoad:!1,enablePagination:!1,enableSidebar:!1,enableSort:!1,enableFilter:!1,get initialData(){return e(S)},onLoad:async a=>{if(!e(y))return[];const n=await F.runProjectSQL2(z,{qstr:e(y),data:[]});return n.status!==200?[]:(e($).length===0&&H(n.data),l(S,t(n.data)),e(S))}})}),d(v,o)},v=>{var o=j(),i=L(o);D(i,()=>e(u)===1,g=>{var a=P(()=>[{name:"Add",action:()=>{l(f,t([...e(f),{sqlName:"",gridName:"",rendererType:"text"}]))}},{name:"Infer",action:()=>{}}]);O(g,{key:"",get handle(){return e(G)},set handle(n){l(G,t(n))},columns:[{title:"SQL Name",key:"sqlName"},{title:"Grid Name",key:"gridName"},{title:"Renderer Type",key:"rendererType",rendererOptions:{autoColor:!0}}],enablePagination:!1,enableSidebar:!1,enableSort:!1,onLoad:async n=>e(f),get headerActions(){return e(a)}})},null,!0),d(v,o)}),m(s),d(r,s)}}}),m(Q),m(M),m(w),d(A,w),X()}Z(["click"]);export{Pe as component};
