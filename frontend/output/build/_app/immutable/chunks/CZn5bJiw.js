import{a as u,t as kt,c as Ga,b as y}from"./uYeY98Ep.js";import{p as Qa,h as U,c as a,r as t,s as e,d as s,t as x,a as Ua,i as E,f as da,b as Ea}from"./CRNwc6nF.js";import{s as n}from"./CdHdDXtF.js";import{i as I}from"./DPugg-eY.js";import{e as ia,i as _a}from"./Bbg2O9W9.js";import{r as va}from"./Bo8IgBjd.js";import{d as Fa,r as Ha}from"./CHLatDmB.js";import{b as ht}from"./C6nodsJR.js";import{p as M}from"./Ycl9y-hy.js";import{p as c}from"./B33JRQ5o.js";import{r as Ja}from"./VksgPlDO.js";import{S as ca}from"./CTtbmK_c.js";import{g as Ka}from"./Cd_4edPv.js";import"./Zb-LiZS2.js";import"./BmWNUg7v.js";import{R as La,a as Va}from"./C1egMclT.js";import"./lZe3btPj.js";import{f as h}from"./8TB5Umy4.js";import"./D8sggRce.js";import"./g85Fs1Im.js";/* empty css        */const Wa=(D,o,i,_,p)=>{o.trigger({type:"component",component:"books_client_picker",meta:{api:i.api,pid:i.pid,onSelect:k=>{_()||_(k.name||""),p(k.id||0)}}})},Ya=(D,o,i,_)=>{o.trigger({type:"component",component:"books_sales_item_pick",meta:{api:i.api,pid:i.pid,onSave:p=>{_().push(p),_(_())}}})},Za=(D,o,i,_)=>{o.trigger({type:"component",component:"books_sales_overall_tax_picker",meta:{sub_total:i(),overall_tax_amount:_(),onSet:p=>{_(p)}}})},$a=(D,o,i,_)=>{o.trigger({type:"component",component:"books_sales_overall_discount_picker",meta:{sub_total:i(),overall_discount_amount:_(),onSet:p=>{_(p)}}})};var te=kt("<span> </span> = <strong> </strong>",1),ae=kt('<tr><td class="px-4 py-2 border"> </td><td class="px-4 py-2 text-right border tabular-nums slashed-zero"> </td><td class="px-4 py-2 text-right border tabular-nums slashed-zero"><!></td><td class="px-4 py-2 text-right border tabular-nums slashed-zero"><!></td><td class="px-4 py-2 text-right border tabular-nums slashed-zero">( <span> <!> <!></span> <strong> </strong></td><td class="px-4 py-2 text-right border tabular-nums slashed-zero"><button class="hover:underline text-warning-800 text-xs">remove</button></td></tr>'),ee=async(D,o,i,_,p,k,N,F,X,q,z,b,S,w,P,B)=>{const O=await o.submit({sale:{title:i(),notes:_(),client_id:p(),client_name:k(),total_item_price:N(),total_item_tax_amount:F(),total_item_discount_amount:X(),sub_total:q(),overall_discount_amount:z(),overall_tax_amount:b(),total:S(),sales_date:w()},lines:P()});E(B,M(O))},re=kt('<form class="p-2"><div class="card"><header class="card-header flex justify-between"><h3 class="h3"> </h3> <div class="w-64"><!></div></header> <section class="p-4 flex flex-col gap-4"><div class="flex gap-2 justify-between"><div class="flex flex-col gap-2"><label class="label"><span>Title</span> <div class="flex gap-2"><input type="text" class="input p-1" placeholder="title"></div></label> <label class="label"><span>Billed To</span> <div class="flex gap-2"><span class="text-sm italic"> </span> <button><!></button></div></label></div> <label class="label"><span>Date</span> <input type="datetime-local" class="input p-1" placeholder="Date"></label></div> <div class="max-h-96 overflow-auto"><table class="w-full text-left table-auto print:text-sm" id="table-items"><thead><tr class="variant-filled print:bg-gray-300 print:text-black"><th class="px-4 py-2">Item</th><th class="px-4 py-2 text-right">Qty</th><th class="px-4 py-2 text-right">Unit Price</th><th class="px-4 py-2 text-right">Tax</th><th class="px-4 py-2 text-right">Subtotal</th><th class="px-4 py-2 text-right"></th></tr></thead><tbody></tbody></table></div> <div class="flex justify-start p-2"><button class="btn btn-sm variant-filled"><!></button></div> <div class="flex gap-2 w-full justify-between"><label class="label flex flex-col gap-2 w-full md:w-1/2"><span>Notes</span> <textarea class="textarea p-1" rows="4" placeholder="Notes about the sale.."></textarea></label> <div class="flex flex-col gap-2 text-sm"><table><tbody><tr><td class="px-2 py-2 border border-gray-400">Total Items TAX</td><td class="px-2 py-2 border border-gray-400 text-right"><span> </span></td></tr><tr><td class="px-2 py-2 border border-gray-400">Total Items Discount</td><td class="px-2 py-2 border border-gray-400 text-right"><span> </span></td></tr><tr><td class="px-2 py-2 border border-gray-400 border-b-gray-800">Sub Total</td><td class="px-2 py-2 border border-gray-400 border-b-gray-800 text-right"><strong> </strong></td></tr><tr><td class="px-2 py-2 border border-gray-800">Overall TAX</td><td class="px-2 py-2 border border-gray-800 text-right"><button class="underline"><span><strong> </strong> <!></span></button></td></tr><tr><td class="px-2 py-2 border border-gray-800">Overall Discount</td><td class="px-2 py-2 border border-gray-800 text-right"><button class="underline"><span><strong> </strong> <!></span></button></td></tr><tr><td class="px-2 py-2 border border-gray-800 font-semibold">Total</td><td class="px-2 py-2 border border-gray-800 text-right font-semibold"> </td></tr></tbody></table></div></div> <div><p class="text-red-500"> </p></div></section> <footer class="card-footer flex justify-end"><button class="btn variant-filled">save</button></footer></div></form>');function Te(D,o){Qa(o,!0);const i=Ka();let _=c(o,"name",3,"New Sale"),p=c(o,"title",15,""),k=c(o,"notes",15,""),N=c(o,"client_id",15,0),F=c(o,"client_name",3,""),X=c(o,"total_item_price",15,0),q=c(o,"total_item_tax_amount",15,0),z=c(o,"total_item_discount_amount",15,0),b=c(o,"sub_total",15,0),S=c(o,"overall_discount_amount",15,0),w=c(o,"overall_tax_amount",15,0),P=c(o,"total",15,0),B=c(o,"sales_date",31,()=>M(new Date().toISOString().slice(0,16))),O=c(o,"modeOptions",19,()=>[["invoice","Invoice"],["direct_sale","Direct Sale"]]),m=c(o,"lines",31,()=>M([])),pa=c(o,"contactsNameIndex",19,()=>({})),St=U(M(O().length>0?O()[0][0]:"")),wt=U(""),H=U(0),J=U(0);Ja(()=>{X(m().reduce((l,r)=>l+r.amount*r.qty,0)),q(m().reduce((l,r)=>l+r.tax_amount*r.qty,0)),z(m().reduce((l,r)=>l+r.discount_amount*r.qty,0)),b(m().reduce((l,r)=>l+r.total_amount,0)),E(H,w()/b()*100),E(J,S()/b()*100),P(b()+w()-S())});var K=re(),Tt=a(K),L=a(Tt),V=a(L),ua=a(V,!0);t(V);var It=e(V,2),ma=a(It);{var ba=l=>{La(l,{children:(r,g)=>{var f=Ga(),T=da(f);ia(T,17,O,_a,(A,j,aa,C)=>{let bt=()=>s(j)[0],xt=()=>s(j)[1];Va(A,{name:"justify",get value(){return bt()},get group(){return s(St)},set group(R){E(St,M(R))},children:(R,G)=>{Ea();var Q=y();x(()=>n(Q,xt())),u(R,Q)},$$slots:{default:!0}})}),u(r,f)},$$slots:{default:!0}})};I(ma,l=>{O().length>0&&l(ba)})}t(It),t(L);var W=e(L,2),Y=a(W),Z=a(Y),$=a(Z),Dt=e(a($),2),Nt=a(Dt);va(Nt),t(Dt),t($);var Ot=e($,2),jt=e(a(Ot),2),tt=a(jt),xa=a(tt,!0);t(tt);var at=e(tt,2);at.__click=[Wa,i,o,p,N];var ga=a(at);ca(ga,{name:"plus",className:"w-4 h-4 inline-block align-middle"}),t(at),t(jt),t(Ot),t(Z);var qt=e(Z,2),zt=e(a(qt),2);va(zt),t(qt),t(Y);var et=e(Y,2),Pt=a(et),At=e(a(Pt));ia(At,21,m,_a,(l,r,g)=>{var f=ae(),T=a(f),A=a(T,!0);t(T);var j=e(T),aa=a(j,!0);t(j);var C=e(j),bt=a(C);{var xt=d=>{var v=y();x(()=>n(v,s(r).amount)),u(d,v)},R=d=>{var v=te(),yt=da(v),Ba=a(yt);t(yt);var na=e(yt,2),Ca=a(na,!0);t(na),x(()=>{n(Ba,`${s(r).price??""} - (${s(r).discount_amount??""})`),n(Ca,s(r).amount)}),u(d,v)};I(bt,d=>{s(r).amount===s(r).price?d(xt):d(R,!1)})}t(C);var G=e(C),Q=a(G);{var qa=d=>{var v=y();x(()=>n(v,s(r).tax_amount)),u(d,v)},za=d=>{var v=y("-");u(d,v)};I(Q,d=>{s(r).tax_amount?d(qa):d(za,!1)})}t(G);var gt=e(G),ft=e(a(gt)),ea=a(ft),ra=e(ea);{var Pa=d=>{var v=y();x(()=>n(v,`- ${s(r).discount_amount??""}`)),u(d,v)};I(ra,d=>{s(r).discount_amount&&d(Pa)})}var Aa=e(ra,2);{var Ra=d=>{var v=y();x(()=>n(v,`+ ${s(r).tax_amount??""}`)),u(d,v)};I(Aa,d=>{s(r).tax_amount&&d(Ra)})}t(ft);var oa=e(ft),sa=e(oa),Ma=a(sa,!0);t(sa),t(gt);var la=e(gt),Xa=a(la);Xa.__click=()=>{m().splice(g,1),m(m())},t(la),t(f),x(()=>{n(A,s(r).info),n(aa,s(r).qty),n(ea,`${s(r).price??""} `),n(oa,` ) * ${s(r).qty??""} = `),n(Ma,s(r).total_amount)}),u(l,f)}),t(At),t(Pt),t(et);var rt=e(et,2),ot=a(rt);ot.__click=[Ya,i,o,m];var fa=a(ot);ca(fa,{name:"plus",className:"w-4 h-4 inline-block align-middle"}),t(ot),t(rt);var st=e(rt,2),lt=a(st),Rt=e(a(lt),2);Ha(Rt),t(lt);var Mt=e(lt,2),Xt=a(Mt),Bt=a(Xt),nt=a(Bt),Ct=e(a(nt)),Gt=a(Ct),ya=a(Gt,!0);t(Gt),t(Ct),t(nt);var dt=e(nt),Qt=e(a(dt)),Ut=a(Qt),ha=a(Ut,!0);t(Ut),t(Qt),t(dt);var it=e(dt),Et=e(a(it)),Ft=a(Et),ka=a(Ft,!0);t(Ft),t(Et),t(it);var _t=e(it),Ht=e(a(_t)),vt=a(Ht);vt.__click=[Za,i,b,w];var Jt=a(vt),ct=a(Jt),Sa=a(ct,!0);t(ct);var wa=e(ct,2);{var Ta=l=>{var r=y();x(g=>n(r,`[${g??""}%]`),[()=>h(s(H))]),u(l,r)};I(wa,l=>{s(H)&&l(Ta)})}t(Jt),t(vt),t(Ht),t(_t);var pt=e(_t),Kt=e(a(pt)),ut=a(Kt);ut.__click=[$a,i,b,S];var Lt=a(ut),mt=a(Lt),Ia=a(mt,!0);t(mt);var Da=e(mt,2);{var Na=l=>{var r=y();x(g=>n(r,`[${g??""}%]`),[()=>h(s(J))]),u(l,r)};I(Da,l=>{s(J)&&l(Na)})}t(Lt),t(ut),t(Kt),t(pt);var Vt=e(pt),Wt=e(a(Vt)),Oa=a(Wt,!0);t(Wt),t(Vt),t(Bt),t(Xt),t(Mt),t(st);var Yt=e(st,2),Zt=a(Yt),ja=a(Zt,!0);t(Zt),t(Yt),t(W);var $t=e(W,2),ta=a($t);ta.__click=[ee,o,p,k,N,F,X,q,z,b,S,w,P,B,m,wt],t($t),t(Tt),t(K),x((l,r,g,f,T,A)=>{n(ua,_()),n(xa,pa()[N()]||""),n(ya,l),n(ha,r),n(ka,g),n(Sa,f),n(Ia,T),n(Oa,A),n(ja,s(wt)),ta.disabled=m().length===0||!N()},[()=>h(q()),()=>h(z()),()=>h(b()),()=>h(w()),()=>h(S()),()=>h(P())]),ht(Nt,p),ht(zt,B),ht(Rt,k),u(D,K),Ua()}Fa(["click"]);export{Te as S};
