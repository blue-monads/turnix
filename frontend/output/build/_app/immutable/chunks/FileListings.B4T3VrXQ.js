import{a as d,n as k,c as nt,t as V,b as it}from"./disclose-version.BOfWGsg9.js";import{t as p,p as st,h as z,f as ct,b as a,a as dt,i as I,g as Bt,u as Ht,c as v,s as f,r as h}from"./runtime.CmPLUjJJ.js";import{s as S}from"./render.CZQ66Y_F.js";import{i as b}from"./if.DoU_1wcm.js";import{e as ot,i as rt}from"./each.BJPUi07-.js";import{s as g,r as At,c as Ct}from"./attributes.yGGqmlPO.js";import{s as Lt}from"./class.BFWsl-fM.js";import{d as Ft}from"./events.DnYA5zBv.js";import{p as H}from"./proxy.DKs42Gzo.js";import{p as n}from"./props.IjRlZquB.js";import{c as St}from"./index-client.Caj9tY0k.js";import"./index.DQ4XhlMg.js";import"./autotable.D5y0wA8l.js";import{L as It}from"./loader._7BlSOYJ.js";import{c as Pt}from"./svelte-component.DHZAe5Z3.js";import{S as X}from"./SvgIcon.Cn9REWmg.js";import{g as lt}from"./entry.SbDQTVSd.js";import{g as Dt}from"./stores.C0Vv8-i4.js";import"./ProgressBar.svelte_svelte_type_style_lang.Kk8Ai2k7.js";var Nt=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="text-purple-500 inline-block bi bi-image" viewBox="0 0 16 16"><path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"></path><path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"></path></svg>');function qt(i,t){let e=n(t,"width",3,"16"),s=n(t,"height",3,"16");var o=Nt();p(()=>{g(o,"width",e()),g(o,"height",s())}),d(i,o)}var Et=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="text-yellow-600 inline-block bi bi-music-note-beamed" viewBox="0 0 16 16"><path d="M6 13c0 1.105-1.12 2-2.5 2S1 14.105 1 13c0-1.104 1.12-2 2.5-2s2.5.896 2.5 2zm9-2c0 1.105-1.12 2-2.5 2s-2.5-.895-2.5-2 1.12-2 2.5-2 2.5.895 2.5 2z"></path><path fill-rule="evenodd" d="M14 11V2h1v9h-1zM6 3v10H5V3h1z"></path><path d="M5 2.905a1 1 0 0 1 .9-.995l8-.8a1 1 0 0 1 1.1.995V3L5 4V2.905z"></path></svg>');function Tt(i,t){let e=n(t,"width",3,"16"),s=n(t,"height",3,"16");var o=Et();p(()=>{g(o,"width",e()),g(o,"height",s())}),d(i,o)}var jt=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="text-indigo-500 inline-block ltr:mr-1 rtl:ml-1 bi bi-file-earmark" viewBox="0 0 16 16"><path d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5h-2z"></path></svg>');function Rt(i,t){let e=n(t,"width",3,"16"),s=n(t,"height",3,"16");var o=jt();p(()=>{g(o,"width",e()),g(o,"height",s())}),d(i,o)}var Ut=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="text-red-500 inline-block bi bi-play-btn-fill" viewBox="0 0 16 16"><path d="M0 12V4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm6.79-6.907A.5.5 0 0 0 6 5.5v5a.5.5 0 0 0 .79.407l3.5-2.5a.5.5 0 0 0 0-.814l-3.5-2.5z"></path></svg>');function Gt(i,t){let e=n(t,"width",3,"16"),s=n(t,"height",3,"16");var o=Ut();p(()=>{g(o,"width",e()),g(o,"height",s())}),d(i,o)}var Kt=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="inline-block bi bi-file-zip" viewBox="0 0 16 16"><path d="M6.5 7.5a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v.938l.4 1.599a1 1 0 0 1-.416 1.074l-.93.62a1 1 0 0 1-1.109 0l-.93-.62a1 1 0 0 1-.415-1.074l.4-1.599V7.5zm2 0h-1v.938a1 1 0 0 1-.03.243l-.4 1.598.93.62.93-.62-.4-1.598a1 1 0 0 1-.03-.243V7.5z"></path><path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm5.5-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9v1H8v1h1v1H8v1h1v1H7.5V5h-1V4h1V3h-1V2h1V1z"></path></svg>');function Ot(i,t){let e=n(t,"width",3,"16"),s=n(t,"height",3,"16");var o=Kt();p(()=>{g(o,"width",e()),g(o,"height",s())}),d(i,o)}function Xt(i,t){st(t,!0);let e=n(t,"name",3,"");const s={image:qt,video:Gt,music:Tt,zip:Ot,other:Rt},o={mp4:"video",jpg:"image",png:"image",webp:"image",mp3:"music",zip:"zip"};let M=I("other");e().includes(".")&&z(M,H(o[e().split(".").pop()]||"other"));var w=nt(),y=ct(w);Pt(y,()=>s[a(M)],(P,D)=>{D(P,{get height(){return t.size},get width(){return t.size}})}),d(i,w),dt()}var Yt=k('<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="inline-block bi bi-folder-fill" viewBox="0 0 16 16"><path d="M9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.825a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31L.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3zm-8.322.12C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139z"></path></svg>');function Zt(i,t){let e=n(t,"size",3,"16");var s=Yt();p(()=>{g(s,"width",e()),g(s,"height",e())}),d(i,s)}var Jt=(i,t,e)=>t("open_item",a(e)),Qt=(i,t,e)=>t("select_item",a(e)),Wt=(i,t,e)=>{t(t()===a(e).name?"":a(e).name)},$t=V('<input type="checkbox">'),te=(i,t,e)=>{console.log("@clicked1",t()),t()(a(e)),console.log("@clicked2",t()),i.preventDefault()},ee=(i,t,e)=>t(a(e)),ae=V('<button class="btn btn-sm variant-filled"><!></button>'),ie=(i,t,e)=>t(i,a(e)),oe=(i,t,e,s)=>{i.stopPropagation(),t("action",{action:a(e),row:a(s)})},re=V('<button class="flex gap-1 justify-start items-center p-1 rounded-lg hover:bg-white hover:text-secondary-600"><!> <p> </p></button>'),le=V('<div class="fixed z-10 shadow-lg w-28 h-max p-1 border border-zinc-200 rounded-lg flex flex-col gap-2 variant-filled"></div>'),ne=V('<tr><td class="w-1"><!></td><td><button class="mr-1 text-indigo-500" type="button"><!> </button></td><td><!></td><td><!></td><td><!> <button class="btn btn-sm variant-filled-secondary relative group transition-all duration-200 focus:overflow-visible overflow-hidden"><!></button> <!></td></tr>'),se=V('<div class="table-container"><table class="table table-hover overflow-auto"><thead><tr><td></td><th>Name</th><th>Created At</th><th>Size</th><th>Action</th></tr></thead><tbody><!></tbody></table></div>');function He(i,t){st(t,!0);const e=r=>{console.log("@exp"),r.is_folder?lt(`${M()}?folder=${w()?w()+"/"+r.name:r.name}`):lt(`${M()}/preview?folder=${w()}&fid=${r.id}&filename=${r.name}`)};let s=n(t,"files",19,()=>[]),o=n(t,"loading",3,!1),M=n(t,"baseUrl",3,"/z/pages/portal/self/files"),w=n(t,"path",3,""),y=n(t,"selected",15),P=n(t,"hidePreview",3,!1),D=n(t,"onExplore",3,e),ht=n(t,"pickMode",3,!1),vt=Bt("__api__");const N=St(),mt=Dt();let Y="32";const gt=[{name:"rename",icon:"pencil-square"},{name:"download",icon:"arrow-down-on-square"},{name:"delete",icon:"trash"}],pt=[{name:"rename",icon:"pencil-square"},{name:"delete",icon:"trash"}];let B=I(!1),A=I(0),q=I(H({top:0,left:0}));const Z=r=>{z(B,!1),z(A,0)};Ht(()=>(document.addEventListener("click",Z),()=>{document.removeEventListener("click",Z)}));const ft=r=>{const _=["Bytes","KB","MB","GB","TB"];if(r===0)return"0 Byte";const u=parseInt(String(Math.floor(Math.log(r)/Math.log(1024))));return u===0?`${r} ${_[u]}`:`${(r/1024**u).toFixed(1)} ${_[u]}`},_t=r=>{mt.trigger({type:"component",component:"file_preview_dialog",meta:{api:vt,fileId:r.id,filename:r.name}})},ut=(r,_)=>{r.stopPropagation();const C=r.currentTarget.getBoundingClientRect();z(q,H({top:C.bottom+window.scrollY,left:C.left+window.scrollX-5})),z(B,H(!a(B)||a(A)!==_.id)),z(A,H(a(B)?_.id:0))};var E=se(),J=v(E),Q=f(v(J)),bt=v(Q);b(bt,o,r=>{It(r,{})},r=>{var _=nt(),u=ct(_);ot(u,17,s,rt,(C,c)=>{var x=ne();x.__dblclick=[Jt,N,c],x.__click=[Qt,N,c];var T=v(x),wt=v(T);b(wt,ht,m=>{var l=$t();At(l),l.__change=[Wt,y,c],p(()=>Ct(l,y()===a(c).name)),d(m,l)}),h(T);var j=f(T),R=v(j);R.__click=[te,D,c];var W=v(R);b(W,()=>a(c).is_folder,m=>{Zt(m,{size:Y})},m=>{Xt(m,{size:Y,get name(){return a(c).name}})});var xt=f(W);h(R),h(j);var U=f(j),zt=v(U);b(zt,()=>a(c).created_at,m=>{var l=it();p(()=>S(l,new Date(a(c).created_at).toLocaleString())),d(m,l)}),h(U);var G=f(U),kt=v(G);b(kt,()=>a(c).size,m=>{var l=it();p(()=>S(l,ft(a(c).size))),d(m,l)}),h(G);var $=f(G),tt=v($);b(tt,()=>!a(c).is_folder&&!P(),m=>{var l=ae();l.__click=[ee,_t,c];var K=v(l);X(K,{name:"eye",className:"w-4 h-4"}),h(l),d(m,l)});var L=f(tt,2);L.__click=[ie,ut,c];var Vt=v(L);X(Vt,{name:"bars-3",className:"w-4 h-4"}),h(L);var Mt=f(L,2);b(Mt,()=>a(B)&&a(A)===a(c).id,m=>{var l=le();ot(l,21,()=>a(c).is_folder?pt:gt,rt,(K,O)=>{var F=re();F.__click=[oe,N,O,c];var et=v(F);X(et,{get name(){return a(O).icon},className:"w-4 h-4"});var at=f(et,2),yt=v(at);h(at),h(F),p(()=>S(yt,a(O).name)),d(K,F)}),h(l),p(()=>g(l,"style",`top: ${a(q).top??""}px; left: ${a(q).left??""}px;`)),d(m,l)}),h($),h(x),p(()=>{Lt(x,`cursor-pointer hover:bg-gray-700 ${(y()===a(c).name?"variant-outline-primary":"")??""}`),S(xt,` ${a(c).name??""}`)}),d(C,x)}),d(r,_)}),h(Q),h(J),h(E),d(i,E),dt()}Ft(["dblclick","click","change"]);export{He as F};
