import{a as r,t as s,c as Z,b as Ne}from"./disclose-version.BOfWGsg9.js";import{p as Be,c as n,b as e,r as t,t as f,s as u,f as z,a as We,i as L,h as _,u as $e,d as Te}from"./runtime.CmPLUjJJ.js";import{s as K}from"./render.CZQ66Y_F.js";import{s as Pe}from"./clone.BmdS7Muu.js";import{i as d}from"./if.DoU_1wcm.js";import{e as re,i as ne}from"./each.BJPUi07-.js";import{r as Re,b as ze,s as Oe,c as ea}from"./attributes.yGGqmlPO.js";import{s as Fe}from"./class.BFWsl-fM.js";import{d as Ge}from"./events.DnYA5zBv.js";import{p as y}from"./proxy.DKs42Gzo.js";import{i as Ve,s as Xe}from"./select.BNLwbYi8.js";import{b as aa}from"./this.DlUubvPq.js";import{p as he}from"./props.IjRlZquB.js";import{S as te}from"./SvgIcon.Cn9REWmg.js";const ta={equal:["value"],not_equal:["value"],contains:["value"],not_contains:["value"],starts_with:["value"],ends_with:["value"],is_null:["novalue"],is_not_null:["novalue"],between:["range"],not_between:["range"],greater_than:["value"],less_than:["value"],greater_than_or_equal:["value"],less_than_or_equal:["value"]},ra=Object.keys(ta);var na=(v,a)=>{e(a).operator=v.target.value},oa=s("<option> </option>"),la=(v,a)=>{e(a).value[0]=v.target.value},sa=(v,a)=>{e(a).value[1]=v.target.value},ia=s('<input class="p-2 border" type="text"> <input class="p-2 border" type="text">',1),va=(v,a)=>{e(a).value[0]=v.target.value},_a=s('<input class="p-2 border" type="text">'),ca=s('<div class="flex flex-col gap-2 border "><select class="p-2"></select> <!></div>'),da=(v,a,o)=>{a.push({fiterType:o.column.type||"text",operator:"equal",value:[]})},ua=(v,a,o)=>{a.applyFilter(a.column,o)},ga=s('<div class="flex flex-col gap-2 text-xs p-1"><!> <button class="btn bg-gray-50 hover:bg-gray-100">add</button> <div class="flex justify-end gap-1"><button class="btn btn-sm variant-filled">close</button> <button class="btn btn-sm variant-filled-tertiary">clear</button> <button class="btn btn-sm variant-filled-primary">apply</button></div></div>');function pa(v,a){Be(a,!0);const o=y(a.currentFilterModel||[{fiterType:a.column.type||"text",operator:"equal",value:[]}]);var D=ga(),V=n(D);re(V,17,()=>o,ne,(Y,g)=>{var oe=ca(),E=n(oe);Ve(E,()=>e(g).operator);var $;E.__change=[na,g],re(E,21,()=>ra,ne,(R,h)=>{var m=oa(),P={},de=n(m);t(m),f(()=>{P!==(P=e(h))&&(m.value=(m.__value=e(h))==null?"":e(h)),K(de,e(h))}),r(R,m)}),t(E);var H=u(E,2);d(H,()=>e(g).operator==="range",R=>{var h=ia(),m=z(h);Re(m),f(()=>ze(m,e(g).value.at(0)||"")),m.__change=[la,g];var P=u(m,2);Re(P),f(()=>ze(P,e(g).value.at(1)||"")),P.__change=[sa,g],r(R,h)},R=>{var h=_a();Re(h),f(()=>ze(h,e(g).value.at(0)||"")),h.__change=[va,g],r(R,h)}),t(oe),f(()=>{$!==($=e(g).operator)&&(E.value=(E.__value=e(g).operator)==null?"":e(g).operator,Xe(E,e(g).operator))}),r(Y,oe)});var _e=u(V,2);_e.__click=[da,o,a];var Se=u(_e,2),Ae=n(Se);Ae.__click=function(...Y){var g;(g=a.closeFilter)==null||g.apply(this,Y)};var ce=u(Ae,2);ce.__click=function(...Y){var g;(g=a.clearFilter)==null||g.apply(this,Y)};var ye=u(ce,2);ye.__click=[ua,a,o],t(Se),t(D),r(v,D),We()}Ge(["change","click"]);var ba=s('<div class="flex justify-center items-center h-full"><span class="text-gray-500">Empty</span></div>'),fa=s('<div class="flex justify-center items-center h-full"><span class="text-gray-500">Loading...</span></div>'),ha=(v,a,o,D,V)=>{!a.enableSort||e(o).disableSort||(e(D)===e(o).key?e(V)==="asc"?_(V,"desc"):_(D,""):(_(D,y(e(o).key)),_(V,"asc")))},ya=(v,a,o)=>{console.log("@col/ev",e(a)),v.stopPropagation(),o(e(a),v)},ma=s('<span class="rounded-full absolute top-1 -right-1 w-2 h-2 bg-blue-400 shadow"></span>'),xa=s("<div><button><!> <!></button></div>"),ka=s('<div class="fixed rounded bg-white shadow-lg z-10 min-w-64 resize p-2 border-b"><!></div>'),wa=s('<th class="px-2 py-1"><div class="flex gap-2"><button class="flex gap-1"><span> </span> <!></button> <!> <!></div></th>'),Fa=(v,a)=>{e(a).action()},Pa=s("<button><!> </button>"),Sa=s('<th class="px-2 py-2 flex"><!></th>'),Aa=s('<tr class="hover:bg-gray-100 border-b border-gray-200 py-10 text-gray-700"><td class="px-2 py-2"><span class="p-1 rounded-lg">Loading...</span></td></tr>'),Ea=s('<tr class="hover:bg-gray-100 border-b border-gray-200 py-10 text-gray-700"><td class="px-2 py-2"><span class="p-1 rounded-lg">Empty</span></td></tr>'),Ca=s('<span class="pill"> </span>'),Na=s("<span><!></span>"),Oa=(v,a,o)=>e(a).action(e(o)[e(a).name],e(o)),Ra=s("<button><!> </button>"),Ia=s('<td class="px-2 py-2 flex flex-row"></td>'),La=s('<td class="px-2 py-2"><!></td> <!>',1),Ma=s('<tr class="hover:bg-gray-100 border-b border-gray-200 py-10 text-gray-700"></tr>'),ja=s('<table class="table-auto border-collapse relative w-full"><thead><tr class="rounded-lg text-sm font-medium text-gray-700 text-left"><!><!></tr></thead><tbody class="text-sm font-normal text-gray-700"><!></tbody></table>'),qa=(v,a,o,D,V)=>{e(a).includes(e(o).key)?_(a,y(e(a).filter(_e=>_e!==e(o).key))):(_(a,y([...e(a),e(o).key])),e(D).includes(e(o).key)||_(V,!0))},Ta=s('<div class="flex"><label class="flex items-center gap-2"><input type="checkbox" class="h-4 w-4 border-gray-300 rounded"> <span> </span></label></div>'),za=s('<div class="flex flex-col gap-2 p-2"></div>'),Da=s('<div class="flex min-w-48 flex-col border-l border-gray-200 p-1 resize-x overflow-auto"><!></div>'),Ba=s('<!> <div class="flex w-6 flex-col border-l border-gray-200 p-1"><div class="flex justify-start gap-4 rotate-90 "><button class="hover:bg-gray-50 px-1">Columns</button></div></div>',1),Wa=async(v,a)=>{a("initial")},Ga=(v,a,o)=>{_(a,y(Number(v.target.value))),_(o,!0),console.log("@ev",v.target.value),console.log(Pe(e(a)))},Va=async(v,a)=>{a("previous")},Xa=async(v,a)=>{a("next")},Ya=s('<div class="flex justify-end gap-2"><button><!></button> <select class="rounded w-20 border-gray-300 border pl-2"><option>25</option><option>50</option><option>100</option><option>250</option></select> <div class="flex gap-2"><button class="btn btn-sm bg-gray-100"><!></button> <button class="btn btn-sm bg-gray-100"><!></button></div></div>'),Ha=s('<div class="p-1 card"><div class="flex"><div class="flex-1 min-h-32 overflow-auto"><!></div> <!></div> <!></div>');function it(v,a){Be(a,!0);let o=he(a,"columns",19,()=>[]),D=he(a,"handle",15),V=he(a,"enableStartAutoLoad",3,!0),_e=he(a,"enableSidebar",3,!1),Se=he(a,"enablePagination",3,!0),Ae=he(a,"enableFilter",3,!0),ce=L(y([])),ye=L("asc"),Y=L(void 0),g=L(0),oe=L(0),E=L(!1),$=L("none"),H=L(25),R=y({}),h=L(y(o().map(l=>l.key))),m=L(y([])),P=L(null),de=L(y({top:0,left:0})),ue=L(!1),ge;const Ye=74;D({reload:()=>le("initial"),next:()=>le("next"),previous:()=>le("previous")});const He=l=>{let i=Ye;for(var c=0;c<l.length;(c+=1)-1)i=l.charCodeAt(c)+((i<<5)-i);return i},Je=(l,i)=>{e(P)===l.key?_(P,null):(_(P,y(l.key)),setTimeout(()=>{if(ge){const c=i.target.getBoundingClientRect(),C=ge.getBoundingClientRect();let p=c.left+window.scrollX;const S=p+C.width,B=window.innerWidth;S>B&&(p=Math.max(0,B-C.width)),_(de,y({top:`${c.bottom+window.scrollY}px`,left:`${p}px`}))}},0))},Ee=()=>{_(P,null),_(de,y({top:0,left:0}))},le=async l=>{_(E,!0),_(ue,!1);let i=Pe(e(h)),c=await a.onLoad({loadType:l,orderBy:e(Y),orderDirection:e(ye),filterModels:Pe(R),activeColumns:i,minId:e(g),maxId:e(oe),pageSize:e(H)});c||(c=[]),De(c),_(E,!1),_(m,y(i))},De=l=>{let i=0,c=0;if(l.length>0){let C=l[0][a.key];c=C,i=C,l.forEach(p=>{const S=p[a.key];S<e(g)&&(i=S),S>e(oe)&&(c=S)})}_(g,y(i)),_(oe,y(c)),_(ce,y(l))};V()?le("initial"):(_(m,y(Pe(e(h)))),De(a.initialData||[])),$e(()=>{const l=i=>{ge&&!ge.contains(i.target)&&Ee()};return document.addEventListener("click",l),()=>{document.removeEventListener("click",l)}});const Qe=l=>()=>{e($)===l?_($,"none"):_($,y(l))};var Ie=Ha(),Le=n(Ie),Me=n(Le),Ue=n(Me);d(Ue,()=>o().length===0,l=>{var i=ba();r(l,i)},l=>{var i=Z(),c=z(i);d(c,()=>e(E),C=>{var p=fa();r(C,p)},C=>{var p=ja(),S=n(p),B=n(S),X=n(B);re(X,17,o,ne,(x,b)=>{var k=Z(),A=z(k);d(A,()=>e(m).includes(e(b).key)&&e(h).includes(e(b).key),w=>{var N=wa(),J=n(N),F=n(J);F.__click=[ha,a,b,Y,ye];var I=n(F),be=n(I);t(I);var j=u(I,2);d(j,()=>e(b).key===e(Y),ve=>{var O=Z(),W=z(O);d(W,()=>e(ye)==="asc",q=>{te(q,{name:"chevron-down",className:"h-4 w-4"})},q=>{te(q,{name:"chevron-up",className:"h-4 w-4"})}),r(ve,O)}),t(F);var ie=u(F,2);d(ie,Ae,ve=>{var O=xa(),W=n(O);W.__click=[ya,b,Je];var q=n(W);d(q,()=>R[e(b).key],me=>{var xe=ma();r(me,xe)});var Q=u(q,2);te(Q,{name:"bars-3-bottom-right",className:"h-4 w-4"}),t(W),t(O),f(()=>Fe(W,`rounded p-0.5 relative ${(R[e(b).key]?"bg-blue-100":"")??""}`)),r(ve,O)});var ee=u(ie,2);d(ee,()=>e(P),ve=>{var O=ka();aa(O,Q=>ge=Q,()=>ge);var W=n(O),q=Te(()=>o().find(Q=>Q.key===e(P)));pa(W,{get currentFilterModel(){return R[e(P)]},closeFilter:Ee,clearFilter:()=>{R[e(P)]=null,_(ue,!0),Ee()},get column(){return e(q)},applyFilter:(Q,me)=>{R[Q.key]=me,_(ue,!0),console.log(Pe(R)),Ee()}}),t(O),f(()=>Oe(O,"style",`top: ${e(de).top??""}; left: ${e(de).left??""};`)),r(ve,O)}),t(J),t(N),f(()=>K(be,e(b).title)),r(w,N)}),r(x,k)});var M=u(X);d(M,()=>a.actions||a.headerActions,x=>{var b=Sa(),k=n(b);d(k,()=>a.headerActions,A=>{var w=Z(),N=z(w);re(N,17,()=>a.headerActions,ne,(J,F)=>{var I=Pa();I.__click=[Fa,F];var be=n(I);d(be,()=>e(F).icon,ie=>{te(ie,{get name(){return e(F).icon},className:"h-5 w-5"})});var j=u(be);t(I),f(()=>{Fe(I,`flex m-1 btn btn-sm bg-gray-50 ${e(F).Class??""}`),K(j,` ${e(F).name??""}`)}),r(J,I)}),r(A,w)},A=>{var w=Ne("Actions");r(A,w)}),t(b),r(x,b)}),t(B),t(S);var se=u(S),pe=n(se);d(pe,()=>e(E),x=>{var b=Aa(),k=n(b);t(b),f(()=>Oe(k,"colspan",o().length)),r(x,b)},x=>{var b=Z(),k=z(b);d(k,()=>e(ce).length===0,A=>{var w=Ea(),N=n(w);t(w),f(()=>Oe(N,"colspan",o().length)),r(A,w)},A=>{var w=Z(),N=z(w);re(N,17,()=>e(ce),ne,(J,F)=>{var I=Ma();re(I,21,o,ne,(be,j)=>{var ie=Z();const ee=Te(()=>e(F)[e(j).key]);var ve=z(ie);d(ve,()=>e(m).includes(e(j).key)&&e(h).includes(e(j).key),O=>{var W=La(),q=z(W),Q=n(q);d(Q,()=>e(ee),xe=>{var U=Na();f(()=>{var T;return Oe(U,"style",`background-color: ${(T=e(j).rendererOptions)!=null&&T.autoColor?`hsl(${He(e(ee))%360}, 100%, 80%)`:""}`)});var je=n(U);d(je,()=>e(j).type==="date"&&e(ee),T=>{var G=Ne();f(()=>K(G,new Date(e(ee)).toLocaleDateString())),r(T,G)},T=>{var G=Z(),Ce=z(G);d(Ce,()=>e(j).type==="number",ke=>{var ae=Ca(),qe=n(ae);t(ae),f(()=>K(qe,e(ee))),r(ke,ae)},ke=>{var ae=Z(),qe=z(ae);d(qe,()=>{var fe;return o().type==="lookup"&&((fe=o().rendererOptions)==null?void 0:fe.mappings)},fe=>{var we=Ne();f(()=>K(we,o().rendererOptions.mappings[e(ee)]||"")),r(fe,we)},fe=>{var we=Ne();f(()=>K(we,e(F)[e(j).key]||"")),r(fe,we)},!0),r(ke,ae)},!0),r(T,G)}),t(U),f(()=>Fe(U,`p-1 rounded-lg ${(e(j).cssClasses||"")??""}`)),r(xe,U)}),t(q);var me=u(q,2);d(me,()=>a.actions,xe=>{var U=Ia();re(U,21,()=>a.actions,ne,(je,T)=>{var G=Ra();G.__click=[Oa,T,F];var Ce=n(G);d(Ce,()=>e(T).icon,ae=>{te(ae,{get name(){return e(T).icon},className:"h-5 w-5"})});var ke=u(Ce);t(G),f(()=>{Fe(G,`flex m-1 text-white transform hover:scale-110 btn btn-sm ${(e(T).Class||"bg-blue-400")??""}`),K(ke,` ${e(T).name??""}`)}),r(je,G)}),t(U),r(xe,U)}),r(O,W)}),r(be,ie)}),t(I),r(J,I)}),r(A,w)},!0),r(x,b)}),t(se),t(p),r(C,p)},!0),r(l,i)}),t(Me);var Ze=u(Me,2);d(Ze,_e,l=>{var i=Ba(),c=z(i);d(c,()=>e($)!="none",X=>{var M=Da(),se=n(M);d(se,()=>e($)==="columns",pe=>{var x=za();re(x,21,o,ne,(b,k)=>{var A=Ta(),w=n(A),N=n(w);Re(N),f(()=>ea(N,e(h).includes(e(k).key))),N.__change=[qa,h,k,m,ue];var J=u(N,2),F=n(J);t(J),t(w),t(A),f(()=>K(F,e(k).title)),r(b,A)}),t(x),r(pe,x)}),t(M),r(X,M)});var C=u(c,2),p=n(C),S=n(p),B=Te(()=>Qe("columns"));S.__click=function(...X){var M;(M=e(B))==null||M.apply(this,X)},t(p),t(C),r(l,i)}),t(Le);var Ke=u(Le,2);d(Ke,()=>!e(E)&&Se(),l=>{var i=Ya(),c=n(i);c.__click=[Wa,le];var C=n(c);te(C,{className:"h-4 w-4",name:"arrow-path"}),t(c);var p=u(c,2);Ve(p,()=>e(H)+"");var S;p.__change=[Ga,H,ue];var B=n(p);B.value=(B.__value="25")==null?"":"25";var X=u(B);X.value=(X.__value="50")==null?"":"50";var M=u(X);M.value=(M.__value="100")==null?"":"100";var se=u(M);se.value=(se.__value="250")==null?"":"250",t(p);var pe=u(p,2),x=n(pe);x.__click=[Va,le];var b=n(x);te(b,{className:"h-4 w-4",name:"chevron-left"}),t(x);var k=u(x,2);k.__click=[Xa,le];var A=n(k);te(A,{className:"h-4 w-4",name:"chevron-right"}),t(k),t(pe),t(i),f(()=>{Fe(c,`btn btn-sm  ${(e(ue)?"bg-blue-200":"bg-gray-50")??""}`),S!==(S=e(H)+"")&&(p.value=(p.__value=e(H)+"")==null?"":e(H)+"",Xe(p,e(H)+""))}),r(l,i)}),t(Ie),r(v,Ie),We()}Ge(["click","change"]);export{it as E};
