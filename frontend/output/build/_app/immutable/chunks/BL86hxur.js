import{a as i,t as F,b as Q,c as T}from"./Celh2SBM.js";import{p as Be,g as Ce,i as x,u as ge,h as a,d as e,t as A,a as Ee,c as r,s as h,f as j,b as B,r as l,e as ie}from"./BC9Cf8Q3.js";import{s as oe}from"./BTw4jHF_.js";import{s as Ge}from"./Bq7wcGJH.js";import{i as U}from"./BgSg1_cg.js";import{e as qe,i as Ae}from"./BqP2cxbq.js";import{s as He}from"./DMueVNEq.js";import{d as Je}from"./x8LL7je8.js";import{p as c}from"./CKwprqj2.js";import{r as Ke}from"./BV18QS1o.js";import"./CRz77-DP.js";import"./B857cCpa.js";import{F as Qe}from"./BcdOKd9a.js";import{R as Te,a as be}from"./7wgplE8L.js";import{F as Ve}from"./L8UBdOXj.js";import{F as We}from"./CsSyBz5E.js";import{S as H}from"./CdW99GA5.js";const Xe=async(R,f,w,d,v,_,V,ne)=>{a(f,!0),e(w)==="personal"?await d.addSelfFile(e(v).name,e(_),e(v)):await d.addProjectFile(String(V),e(v).name,e(_),e(v)),a(v,void 0),a(ne,"listing")};var Ye=F("<!> <!>",1),Ze=(R,f,w,d)=>{a(f,""),a(w,""),a(d,"listing")},ea=F('<li class="crumb"> </li> <li class="crumb-separator" aria-hidden="true">/</li>',1),aa=F('<div slot="lead" class="flex justify-center"><!></div>'),ta=F('<div class="flex-shrink-0 w-32 h-32"><img alt="" class="w-full h-auto"></div> <span> </span>',1),sa=F("<strong>Upload a file</strong> or drag and drop",1),ra=F('<!> <div class="flex justify-end py-2"><button class="btn btn-sm variant-filled"><!></button></div>',1),la=F('<div class="w-auto h-full max-h-96 max-w-xs md:max-w-screen-md overflow-auto"><!></div>'),ia=(R,f,w,d,v,_)=>{e(f)==="preview"||e(f)==="upload"?(a(w,void 0),a(f,"listing")):e(d)==="personal"?a(v,c(e(v).substring(0,e(v).lastIndexOf("/")))):a(_,c(e(_).substring(0,e(_).lastIndexOf("/"))))},oa=(R,f)=>{a(f,"upload")},na=(R,f,w,d)=>{const v=e(f).find(_=>_.name===e(w));if(v){d==null||d(v);return}console.log("@clicked")},da=F('<button class="btn btn-sm variant-filled-primary"><!> <span class="hidden md:inline">Upload</span></button> <button class="btn btn-sm variant-filled"><!> <span class="hidden md:inline">Pick</span></button>',1),va=F('<div class="w-full bg-white md:min-w-[724px] h-full"><div class="flex justify-between bg-slate-200 items-center px-2 rounded"><div class="flex items-center"><h4 class="h4 py-2">File Picker</h4></div> <div class="flex items-center"><!></div></div> <div class="flex justify-between p-1"><ol class="breadcrumb"><li class="crumb"><button><!></button></li> <!> <li class="crumb"> </li></ol></div> <div class="py-2 text-xs"><!></div> <div class="flex justify-between"><button class="btn btn-sm bg-gray-100"><!></button> <div class="flex gap-2"><!></div></div></div>');function Sa(R,f){Be(f,!0);let w=Ke(f,["$$slots","$$events","$$legacy"]),{api:d=Ce("__api__"),pid:v,tabMode:_="all",onPick:V,pickMode:ne="all"}=w;console.log("@props",Ge(w));let D=x(c([])),J=x(!1),I=x(""),L=x(""),M=x(void 0),de=x(!1),N=x(void 0),u=x("listing"),y=x(c(_==="project"?"project":"personal"));const xe=async t=>{console.log("onDrop",t),a(M,c(t.target.files[0]))},he=async t=>{a(J,!0);const s=await d.listSelfFiles(t);s.status===200&&(a(D,c(s.data)),a(J,!1))},we=async(t,s)=>{a(J,!0);const o=await d.listProjectFiles(t,s);o.status===200&&a(D,c(o.data))};ge(()=>{console.log("@effect"),a(u,"listing"),a(N,void 0),e(y)==="personal"?(a(D,c([])),he(e(I))):(a(D,c([])),we(String(v),e(L)))});let C=x(!1);ge(()=>{if(e(u)==="preview"){a(C,!1);return}if(e(u)==="upload"){a(C,!1);return}e(y)==="personal"?a(C,e(I)===""):a(C,e(L)==="")});let ye=ie(()=>(e(y)==="personal"?e(I):e(L)).split("/")),E=x("");var W=va(),X=r(W),ve=h(r(X),2),$e=r(ve);{var ke=t=>{Te(t,{children:(s,o)=>{var P=Ye(),g=j(P);be(g,{name:"justify",value:"personal",padding:"p-0.5 px-2 text-sm",get group(){return e(y)},set group(n){a(y,c(n))},children:(n,k)=>{B();var $=Q("Personal");i(n,$)},$$slots:{default:!0}});var p=h(g,2);be(p,{name:"justify",value:"project",padding:"p-0.5 px-2 text-sm",get group(){return e(y)},set group(n){a(y,c(n))},children:(n,k)=>{B();var $=Q("Project");i(n,$)},$$slots:{default:!0}}),i(s,P)},$$slots:{default:!0}})};U($e,t=>{_==="all"&&t(ke)})}l(ve),l(X);var Y=h(X,2),ce=r(Y),Z=r(ce),ee=r(Z);ee.__click=[Ze,I,L,u];var je=r(ee);H(je,{className:"h-4 w-4",name:"home"}),l(ee),l(Z);var fe=h(Z,2);qe(fe,17,()=>e(ye),Ae,(t,s)=>{var o=T(),P=j(o);{var g=p=>{var n=ea(),k=j(n),$=r(k,!0);l(k),B(2),A(()=>oe($,e(s))),i(p,n)};U(P,p=>{e(s)&&p(g)})}i(t,o)});var pe=h(fe,2),Fe=r(pe,!0);l(pe),l(ce),l(Y);var ae=h(Y,2),Pe=r(ae);{var Se=t=>{Ve(t,{get files(){return e(D)},loading:!1,pickMode:!0,hidePreview:!0,onExplore:s=>{if(s.is_folder){const o=s.path?`${s.path}/${s.name}`:s.name;e(y)==="personal"?a(I,c(o)):a(L,c(o))}else a(N,c(s)),a(u,"preview");a(E,""),console.log("@@explore",s.path)},get selected(){return e(E)},set selected(s){a(E,c(s))}})},Ue=t=>{var s=T(),o=j(s);{var P=p=>{var n=ra(),k=j(n);Qe(k,{name:"files",$$events:{change:xe},$$slots:{lead:(m,b)=>{var O=aa(),re=r(O);H(re,{name:"arrow-up-tray",className:"w-6 h-6"}),l(O),i(m,O)},message:(m,b)=>{var O=T(),re=j(O);{var De=z=>{var K=ta(),le=j(K),Me=r(le);l(le);var ue=h(le,2),Oe=r(ue,!0);l(ue),A(ze=>{He(Me,"src",ze),oe(Oe,e(M).name)},[()=>URL.createObjectURL(e(M))]),i(z,K)},Le=z=>{var K=sa();B(),i(z,K)};U(re,z=>{e(M)?z(De):z(Le,!1)})}i(m,O)}}});var $=h(k,2),S=r($);S.__click=[Xe,de,y,d,M,I,v,u];var q=r(S);{var te=m=>{var b=Q("Uploading...");i(m,b)},se=m=>{var b=Q("Upload");i(m,b)};U(q,m=>{e(J)?m(te):m(se,!1)})}l(S),l($),A(()=>S.disabled=!e(M)||e(de)),i(p,n)},g=p=>{var n=T(),k=j(n);{var $=S=>{var q=la(),te=r(q);const se=ie(()=>{var b;return String((b=e(N))==null?void 0:b.id)}),m=ie(()=>{var b;return(b=e(N))==null?void 0:b.name});We(te,{api:d,get fileId(){return e(se)},get filename(){return e(m)}}),l(q),i(S,q)};U(k,S=>{e(N)&&S($)},!0)}i(p,n)};U(o,p=>{e(u)==="upload"?p(P):p(g,!1)},!0)}i(t,s)};U(Pe,t=>{e(u)==="listing"?t(Se):t(Ue,!1)})}l(ae);var me=h(ae,2),G=r(me);G.__click=[ia,u,N,y,I,L];var Ie=r(G);H(Ie,{className:"h-4 w-4",name:"chevron-left"}),l(G);var _e=h(G,2),Ne=r(_e);{var Re=t=>{var s=da(),o=j(s);o.__click=[oa,u];var P=r(o);H(P,{className:"h-4 w-4",name:"cloud-arrow-up"}),B(2),l(o);var g=h(o,2);g.__click=[na,D,E,V];var p=r(g);H(p,{className:"h-4 w-4",name:"check"}),B(2),l(g),A(()=>g.disabled=e(E)===""),i(t,s)};U(Ne,t=>{e(u)!=="upload"&&t(Re)})}l(_e),l(me),l(W),A(()=>{var t;oe(Fe,(t=e(N))==null?void 0:t.name),G.disabled=e(C)}),i(R,W),Ee()}Je(["click"]);export{Sa as F};
