import{a as A,t as P}from"./disclose-version.BOfWGsg9.js";import{p as Y,g as H,i as E,t as J,a as Z,h as b,b as a,s as o,c as s,r as e,d as $}from"./runtime.CmPLUjJJ.js";import{s as aa}from"./render.CZQ66Y_F.js";import{i as ta}from"./if.DoU_1wcm.js";import{e as ea,i as sa}from"./each.BJPUi07-.js";import{r as ra,s as oa}from"./attributes.yGGqmlPO.js";import{d as la}from"./events.DnYA5zBv.js";import{r as ia}from"./misc.CveY8KIp.js";import{b as K}from"./input.BRsTNa69.js";import{p as d}from"./proxy.DKs42Gzo.js";import{s as na,a as ca}from"./store.BN9B0iWR.js";import{S as I}from"./SvgIcon.Cn9REWmg.js";import{F as da}from"./FilePicker.CSoRamCE.js";import{p as pa}from"./stores.DkdCKZTz.js";var ma=async(p,t,l,i)=>{console.log("@delete_file",a(t));try{await l.deleteShareFile(a(t))}catch(r){console.error(r)}b(i,d(a(i).replace(a(t),"")))},va=P('<img alt="" class="w-full max-w-32 h-auto">'),_a=P('<div class="p-1 rounded bg-white relative min-w-20 min-h-20 self-start"><button class="btn btn-sm absolute top-0 right-0"><!></button> <!></div>'),fa=(p,t,l,i,r)=>{t.show(da,{pid:l,onPick:async u=>{t.close();const n=await i.sharedFile(u.id);n.status===200&&b(r,d(a(r)===""?n.data:a(r)+","+n.data))}})},ba=(p,t,l,i,r)=>{t.onSave({title:a(l),notes:a(i),attachments:a(r)})},ua=P('<div class="card"><header class="card-header"><h4 class="h4"> </h4></header> <section class="p-4 flex flex-col gap-4"><label class="label"><span>Title</span> <input class="input p-1" type="text" placeholder="Input"></label> <label class="label"><span>Notes</span> <textarea class="textarea p-1" rows="4" placeholder="Notes description"></textarea></label> <div class="flex flex-col gap-2"><span>Files</span> <div class="flex justify-items-start flex-wrap gap-2 p-2"></div> <button class="btn btn-sm variant-filled-secondary w-10"><!></button></div></section> <footer class="card-footer flex justify-end"><button type="button" class="btn variant-filled">save</button></footer></div>');function Ba(p,t){var q,z,D;Y(t,!0);const l=na(),r=ca(pa,"$page",l).params.pid,u=H("__vs_modal__"),n=H("__api__");let m=E(d(((q=t.data)==null?void 0:q.title)||"")),v=E(d(((z=t.data)==null?void 0:z.notes)||"")),_=E(d(((D=t.data)==null?void 0:D.attachments)||"")),M=$(()=>a(_).split(",").filter(Boolean));const O=["jpg","jpeg","png","gif","webp","svg"];var h=ua(),g=s(h),B=s(g),Q=s(B);e(B),e(g);var x=o(g,2),w=s(x),C=o(s(w),2);ra(C),e(w);var k=o(w,2),L=o(s(k),2);ia(L),e(k);var R=o(k,2),y=o(s(R),2);ea(y,21,()=>a(M),sa,(c,F)=>{var S=_a(),f=s(S);f.__click=[ma,F,n,_];var W=s(f);I(W,{name:"x-mark",className:"w-4 h-4"}),e(f);var X=o(f,2);ta(X,()=>O.includes(a(F).split(".").at(-1)),j=>{var G=va();J(()=>oa(G,"src",n.getSharedFileURL(a(F)))),A(j,G)},j=>{I(j,{name:"document",className:"w-16 h-16 text-gray-600"})}),e(S),A(c,S)}),e(y);var N=o(y,2);N.__click=[fa,u,r,n,_];var V=s(N);I(V,{name:"plus",className:"w-6 h-6"}),e(N),e(R),e(x);var T=o(x,2),U=s(T);U.__click=[ba,t,m,v,_],e(T),e(h),J(()=>{aa(Q,t.data?"Edit Note":"Add Note"),U.disabled=!a(m)||!a(v)}),K(C,()=>a(m),c=>b(m,c)),K(L,()=>a(v),c=>b(v,c)),A(p,h),Z()}la(["click"]);export{Ba as N};
