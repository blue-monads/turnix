import{c as Ve,a as c,t as b,b as ve}from"./uYeY98Ep.js";import{p as Le,h as A,g as ze,f as Me,a as Pe,i as m,d as i,c as s,r as o,s as a,t as ue,b as Re,e as j}from"./CRNwc6nF.js";import{s as We}from"./CdHdDXtF.js";import{i as f}from"./DPugg-eY.js";import{e as Xe,i as qe}from"./Bbg2O9W9.js";import{r as E,b as Ae}from"./Bo8IgBjd.js";import{d as Be}from"./CHLatDmB.js";import{b as B}from"./C6nodsJR.js";import{b as G}from"./D2s8Z0_2.js";import{p}from"./B33JRQ5o.js";import{s as Ge,a as Ke}from"./xNd68Pov.js";import{p as K}from"./Ycl9y-hy.js";import{_ as _e}from"./BvOjxJ8m.js";import{L as Qe}from"./DDEYG0vs.js";import{p as Ye}from"./BIb1nXgJ.js";import{C as Ze,u as $e}from"./LuMZZBmK.js";import{l as et,s as tt,j as at}from"./BbxmcxOi.js";const ot=`


/**
 * @typedef {Object} Context
 * @property {number} event_id - The ID of the event.
 * @property {string} event_type - The type of the event.
 * @property {string} hook_type - The type of the hook.
 * @property {number} session_user - The ID of the session user.
 * @property {number} runas_user - The ID of the user running as another user.
 * @property {function(): Object.<string, any>} getData - Function to get data.
 * @property {function(): [string, string]} getUserToken - Function to get the user token.
 * 
 * Handles the given context.
 *
 * @param {Context} ctx - The context object.
 */
const handle = (ctx) => {
  
};

`,st={ctx:{event_id:0,event_type:"",hook_type:"",session_user:0,runas_user:0,getUserToken:()=>["",""],getData:()=>{}},fetchSync:null};var nt=b("<option> </option>"),rt=b('<div class="flex gap-2 items-center"><input class="input p-1 w-44" type="text" disabled placeholder="John"> <div class="pt-4 inline-flex justify-self-center"><button class="variant-filled btn btn-sm">pick</button></div></div>'),lt=b('<label class="label"><span>Script Code</span> <div class="p-1 rounded border bg-white max-h-screen"><!></div></label>'),it=b('<label class="label"><span>Endpoint</span> <input class="input p-0.5" type="url" placeholder="http://example.com/receive"></label>'),pt=b('<label class="label"><span>Handler</span> <input class="input p-0.5" type="url" placeholder="handleXyz"></label>'),ct=async(Q,l,y,h,N,k,x,u,v,g,_,d,C)=>{m(l,!0),i(y)==="context_user"?h(0):i(y)==="no_user"&&h(-1),await N()({id:k(),name:x(),hook_code:u(),runas_user_id:h(),hook_type:v(),envs:g(),extrameta:_(),target:d(),event:C()}),m(l,!1)},vt=b('<div class="flex p-2 flex-col gap-2"><div class="card p-4 flex flex-col gap-2"><header class="card-header"><h4 class="h4"><!></h4></header> <section class="p-4 flex flex-col gap-4"><label class="label"><span>Name</span> <input class="input p-0.5" type="text" placeholder="name"></label> <label class="label"><span>Event Type</span> <select class="select"></select></label> <label class="flex items-center space-x-2"><p>Run as</p> <select class="select w-44"><option>Specific User</option><option>Context User</option><option>No User</option></select></label> <!> <label class="label"><span>Hook Type</span> <select class="select"><option>Script</option><option>Native Function</option><option>Webhook</option></select></label> <!> <!> <!> <div class="label"><span>Extrameta</span> <!></div> <div class="label"><span>Env Vars</span> <!></div></section> <footer class="card-footer flex justify-end"><button class="btn btn-sm variant-filled">save</button></footer></div></div>');function Ot(Q,l){Le(l,!0);const[y,h]=Ge(),N=()=>Ke(Ye,"$params",y);let k=p(l,"id",3,0),x=p(l,"hook_code",31,()=>K(ot)),u=p(l,"runas_user_id",31,()=>-1),v=p(l,"hook_type",15,"webhook"),g=p(l,"target",15,""),_=p(l,"envs",15,"{}"),d=p(l,"extrameta",15,"{}"),C=p(l,"event",15,""),Y=p(l,"name",15,""),de=p(l,"onSave",3,async r=>{}),S=A(K(u()===-1?"no_user":u()===0?"context_user":"specific_user"));const fe=N().ptype,me=ze("__api__");let Z=A(void 0),T=A(!0),be={};(async()=>{m(T,!0);const r=await me.getProjectType(fe);r.status===200&&(m(Z,K(r.data)),m(T,!1))})();const he=r=>{console.log("handleExtrametaChange",r),d(JSON.stringify(r))},xe=r=>{console.log("handleEnvVarChange",r),_(JSON.stringify(r))};var $=Ve(),ge=Me($);{var ye=r=>{Qe(r,{})},ke=r=>{var O=vt(),ee=s(O),H=s(ee),te=s(H),Ce=s(te);{var Se=e=>{var t=ve("New Hook");c(e,t)},Te=e=>{var t=ve("Edit Hook");c(e,t)};f(Ce,e=>{k()===0?e(Se):e(Te,!1)})}o(te),o(H);var D=a(H,2),J=s(D),ae=a(s(J),2);E(ae),o(J);var U=a(J,2),F=a(s(U),2);Xe(F,21,()=>i(Z).event_types||[],qe,(e,t)=>{var n=nt(),w={},q=s(n,!0);o(n),ue(()=>{w!==(w=i(t))&&(n.value=(n.__value=i(t))==null?"":i(t)),We(q,i(t))}),c(e,n)}),o(F),o(U);var I=a(U,2),V=a(s(I),2),L=s(V);L.value=(L.__value="specific_user")==null?"":"specific_user";var z=a(L);z.value=(z.__value="context_user")==null?"":"context_user";var oe=a(z);oe.value=(oe.__value="no_user")==null?"":"no_user",o(V),o(I);var se=a(I,2);{var we=e=>{var t=rt(),n=s(t);E(n),Re(2),o(t),ue(()=>Ae(n,be[u()]||"")),c(e,t)};f(se,e=>{i(S)==="specific_user"&&e(we)})}var M=a(se,2),P=a(s(M),2),R=s(P);R.value=(R.__value="script")==null?"":"script";var W=a(R);W.value=(W.__value="native_function")==null?"":"native_function";var ne=a(W);ne.value=(ne.__value="webhook")==null?"":"webhook",o(P),o(M);var re=a(M,2);{var je=e=>{var t=lt(),n=a(s(t),2),w=s(n);const q=j(()=>[$e({activateOnTyping:!0,override:[et,tt(st)]})]),Fe=j(at);Ze(w,{get extensions(){return i(q)},get lang(){return i(Fe)},get value(){return x()},set value(Ie){x(Ie)}}),o(n),o(t),c(e,t)};f(re,e=>{v()==="script"&&e(je)})}var le=a(re,2);{var Ee=e=>{var t=it(),n=a(s(t),2);E(n),o(t),B(n,g),c(e,t)};f(le,e=>{v()==="webhook"&&e(Ee)})}var ie=a(le,2);{var Ne=e=>{var t=pt(),n=a(s(t),2);E(n),o(t),B(n,g),c(e,t)};f(ie,e=>{v()==="native_function"&&e(Ne)})}var X=a(ie,2),Oe=a(s(X),2);const He=j(()=>d()?JSON.parse(d()):{});_e(Oe,{get data(){return i(He)},onChange:he}),o(X);var pe=a(X,2),De=a(s(pe),2);const Je=j(()=>_()?JSON.parse(_()):{});_e(De,{sensitive:!0,get data(){return i(Je)},onChange:xe}),o(pe),o(D);var ce=a(D,2),Ue=s(ce);Ue.__click=[ct,T,S,u,de,k,Y,x,v,_,d,g,C],o(ce),o(ee),o(O),B(ae,Y),G(F,C),G(V,()=>i(S),e=>m(S,e)),G(P,v),c(r,O)};f(ge,r=>{i(T)?r(ye):r(ke,!1)})}c(Q,$),Pe(),h()}Be(["click"]);export{Ot as H};
