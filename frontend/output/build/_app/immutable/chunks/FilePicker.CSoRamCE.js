import{c as H,a as i,b as J,t as F}from"./disclose-version.BOfWGsg9.js";import{p as Pe,g as Se,i as x,u as fe,f as j,b as e,t as O,h as a,a as Ue,c as s,s as h,r,e as z,d as te}from"./runtime.CmPLUjJJ.js";import{s as se}from"./render.CZQ66Y_F.js";import{s as Ie}from"./clone.BmdS7Muu.js";import{i as P}from"./if.DoU_1wcm.js";import{e as Ne,i as Re}from"./each.BJPUi07-.js";import{s as De}from"./attributes.yGGqmlPO.js";import{d as Le}from"./events.DnYA5zBv.js";import{p}from"./proxy.DKs42Gzo.js";import{r as Me}from"./props.IjRlZquB.js";import"./ProgressBar.svelte_svelte_type_style_lang.B5GFseBd.js";import{F as Oe}from"./FileDropzone.BGHgyyHq.js";import{R as ze,a as me}from"./RadioItem.mNSZlwlq.js";import{F as Be}from"./FileListings.BICxi2bl.js";import{F as Ce}from"./FilePreview.CIuWA17h.js";import{S as G}from"./SvgIcon.Cn9REWmg.js";const Ee=async(R,f,$,o,d,u,K,re)=>{a(f,!0),e($)==="personal"?await o.addSelfFile(e(d).name,e(u),e(d)):await o.addProjectFile(String(K),e(d).name,e(u),e(d)),a(d,void 0),a(re,"listing")};var Ge=F("<!> <!>",1),qe=(R,f,$,o)=>{a(f,""),a($,""),a(o,"listing")},Ae=F('<li class="crumb"> </li> <li class="crumb-separator" aria-hidden="true">/</li>',1),He=F('<div slot="lead" class="flex justify-center"><!></div>'),Je=F('<div class="flex-shrink-0 w-32 h-32"><img alt="" class="w-full h-auto"></div> <span> </span>',1),Ke=F("<strong>Upload a file</strong> or drag and drop",1),Qe=F('<!> <div class="flex justify-end py-2"><button class="btn btn-sm variant-filled"><!></button></div>',1),Te=F('<div class="w-auto h-full max-h-96 max-w-xs md:max-w-screen-md overflow-auto"><!></div>'),Ve=(R,f,$,o,d,u)=>{e(f)==="preview"||e(f)==="upload"?(a($,void 0),a(f,"listing")):e(o)==="personal"?a(d,p(e(d).substring(0,e(d).lastIndexOf("/")))):a(u,p(e(u).substring(0,e(u).lastIndexOf("/"))))},We=(R,f)=>{a(f,"upload")},Xe=(R,f,$,o)=>{const d=e(f).find(u=>u.name===e($));if(d){o==null||o(d);return}console.log("@clicked")},Ye=F('<button class="btn btn-sm variant-filled-primary"><!> <span class="hidden md:inline">Upload</span></button> <button class="btn btn-sm variant-filled"><!> <span class="hidden md:inline">Pick</span></button>',1),Ze=F('<div class="w-full bg-white md:min-w-[724px] h-full"><div class="flex justify-between bg-slate-200 items-center px-2 rounded"><div class="flex items-center"><h4 class="h4 py-2">File Picker</h4></div> <div class="flex items-center"><!></div></div> <div class="flex justify-between p-1"><ol class="breadcrumb"><li class="crumb"><button><!></button></li> <!> <li class="crumb"> </li></ol></div> <div class="py-2 text-xs"><!></div> <div class="flex justify-between"><button class="btn btn-sm bg-gray-100"><!></button> <div class="flex gap-2"><!></div></div></div>');function ua(R,f){Pe(f,!0);let $=Me(f,["$$slots","$$events","$$legacy"]),{api:o=Se("__api__"),pid:d,tabMode:u="all",onPick:K,pickMode:re="all"}=$;console.log("@props",Ie($));let D=x(p([])),q=x(!1),S=x(""),L=x(""),M=x(void 0),le=x(!1),U=x(void 0),g=x("listing"),w=x(p(u==="project"?"project":"personal"));const _e=async l=>{console.log("onDrop",l),a(M,p(l.target.files[0]))},ue=async l=>{a(q,!0);const t=await o.listSelfFiles(l);t.status===200&&(a(D,p(t.data)),a(q,!1))},ge=async(l,t)=>{a(q,!0);const n=await o.listProjectFiles(l,t);n.status===200&&a(D,p(n.data))};fe(()=>{console.log("@effect"),a(g,"listing"),a(U,void 0),e(w)==="personal"?(a(D,p([])),ue(e(S))):(a(D,p([])),ge(String(d),e(L)))});let B=x(!1);fe(()=>{if(e(g)==="preview"){a(B,!1);return}if(e(g)==="upload"){a(B,!1);return}e(w)==="personal"?a(B,e(S)===""):a(B,e(L)==="")});let be=te(()=>(e(w)==="personal"?e(S):e(L)).split("/")),C=x("");var Q=Ze(),T=s(Q),ie=h(s(T),2),xe=s(ie);P(xe,()=>u==="all",l=>{ze(l,{children:(t,n)=>{var y=Ge(),v=j(y);me(v,{get group(){return e(w)},set group(c){a(w,p(c))},name:"justify",value:"personal",padding:"p-0.5 px-2 text-sm",children:(c,m)=>{z();var I=J("Personal");i(c,I)},$$slots:{default:!0}});var b=h(v,2);me(b,{get group(){return e(w)},set group(c){a(w,p(c))},name:"justify",value:"project",padding:"p-0.5 px-2 text-sm",children:(c,m)=>{z();var I=J("Project");i(c,I)},$$slots:{default:!0}}),i(t,y)},$$slots:{default:!0}})}),r(ie),r(T);var V=h(T,2),ne=s(V),W=s(ne),X=s(W);X.__click=[qe,S,L,g];var he=s(X);G(he,{className:"h-4 w-4",name:"home"}),r(X),r(W);var oe=h(W,2);Ne(oe,17,()=>e(be),Re,(l,t)=>{var n=H(),y=j(n);P(y,()=>e(t),v=>{var b=Ae(),c=j(b),m=s(c);r(c),z(2),O(()=>se(m,e(t))),i(v,b)}),i(l,n)});var de=h(oe,2),$e=s(de);r(de),r(ne),r(V);var Y=h(V,2),we=s(Y);P(we,()=>e(g)==="listing",l=>{Be(l,{get files(){return e(D)},loading:!1,pickMode:!0,get selected(){return e(C)},set selected(t){a(C,p(t))},hidePreview:!0,onExplore:t=>{if(t.is_folder){const n=t.path?`${t.path}/${t.name}`:t.name;e(w)==="personal"?a(S,p(n)):a(L,p(n))}else a(U,p(t)),a(g,"preview");a(C,""),console.log("@@explore",t.path)}})},l=>{var t=H(),n=j(t);P(n,()=>e(g)==="upload",y=>{var v=Qe(),b=j(v);Oe(b,{name:"files",$$events:{change:_e},$$slots:{lead:(k,N)=>{var _=He(),Z=s(_);G(Z,{name:"arrow-up-tray",className:"w-6 h-6"}),r(_),i(k,_)},message:(k,N)=>{var _=H(),Z=j(_);P(Z,()=>e(M),ee=>{var A=Je(),ae=j(A),je=s(ae);O(()=>De(je,"src",URL.createObjectURL(e(M)))),r(ae);var pe=h(ae,2),Fe=s(pe);r(pe),O(()=>se(Fe,e(M).name)),i(ee,A)},ee=>{var A=Ke();z(),i(ee,A)}),i(k,_)}}});var c=h(b,2),m=s(c);m.__click=[Ee,le,w,o,M,S,d,g];var I=s(m);P(I,()=>e(q),k=>{var N=J("Uploading...");i(k,N)},k=>{var N=J("Upload");i(k,N)}),r(m),r(c),O(()=>m.disabled=!e(M)||e(le)),i(y,v)},y=>{var v=H(),b=j(v);P(b,()=>e(U),c=>{var m=Te(),I=s(m),k=te(()=>{var _;return String((_=e(U))==null?void 0:_.id)}),N=te(()=>{var _;return(_=e(U))==null?void 0:_.name});Ce(I,{api:o,get fileId(){return e(k)},get filename(){return e(N)}}),r(m),i(c,m)},null,!0),i(y,v)},!0),i(l,t)}),r(Y);var ve=h(Y,2),E=s(ve);E.__click=[Ve,g,U,w,S,L];var ye=s(E);G(ye,{className:"h-4 w-4",name:"chevron-left"}),r(E);var ce=h(E,2),ke=s(ce);P(ke,()=>e(g)!=="upload",l=>{var t=Ye(),n=j(t);n.__click=[We,g];var y=s(n);G(y,{className:"h-4 w-4",name:"cloud-arrow-up"}),z(2),r(n);var v=h(n,2);v.__click=[Xe,D,C,K];var b=s(v);G(b,{className:"h-4 w-4",name:"check"}),z(2),r(v),O(()=>v.disabled=e(C)===""),i(l,t)}),r(ce),r(ve),r(Q),O(()=>{var l;se($e,(l=e(U))==null?void 0:l.name),E.disabled=e(B)}),i(R,Q),Ue()}Le(["click"]);export{ua as F};
